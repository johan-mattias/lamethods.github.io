<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.2.269">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">

<meta name="author" content="Sonsoles López-Pernas">
<meta name="author" content="Mohammed Saqr">
<meta name="author" content="Satu Helske">
<meta name="author" content="Keefe Murphy">
<meta name="keywords" content="learning analytics, multichannel sequence analysis, mixture hidden markov models, multimodal data">

<title>Learning analytics methods and tutorials - 13&nbsp; Multi-channel sequence analysis in educational research: An introduction and tutorial with R</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1.6em;
  vertical-align: middle;
}
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { color: #008000; } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { color: #008000; font-weight: bold; } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
div.csl-bib-body { }
div.csl-entry {
  clear: both;
}
.hanging div.csl-entry {
  margin-left:2em;
  text-indent:-2em;
}
div.csl-left-margin {
  min-width:2em;
  float:left;
}
div.csl-right-inline {
  margin-left:2em;
  padding-left:1em;
}
div.csl-indent {
  margin-left: 2em;
}
</style>


<script src="../../site_libs/quarto-nav/quarto-nav.js"></script>
<script src="../../site_libs/quarto-nav/headroom.min.js"></script>
<script src="../../site_libs/clipboard/clipboard.min.js"></script>
<script src="../../site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="../../site_libs/quarto-search/fuse.min.js"></script>
<script src="../../site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="../../">
<link href="../../chapters/ch14-process-mining/ch14-process.html" rel="next">
<link href="../../chapters/ch12-markov/ch12-markov.html" rel="prev">
<script src="../../site_libs/cookie-consent/cookie-consent.js"></script>
<link href="../../site_libs/cookie-consent/cookie-consent.css" rel="stylesheet">
<script src="../../site_libs/quarto-html/quarto.js"></script>
<script src="../../site_libs/quarto-html/popper.min.js"></script>
<script src="../../site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="../../site_libs/quarto-html/anchor.min.js"></script>
<link href="../../site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="../../site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="../../site_libs/bootstrap/bootstrap.min.js"></script>
<link href="../../site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="../../site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "sidebar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "start",
  "type": "textbox",
  "limit": 20,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit"
  }
}</script>
<script async="" src="https://www.googletagmanager.com/gtag/js?id=G-Y4VBV3J9WD"></script>

<script type="text/plain" cookie-consent="tracking">

window.dataLayer = window.dataLayer || [];
function gtag(){dataLayer.push(arguments);}
gtag('js', new Date());
gtag('config', 'G-Y4VBV3J9WD', { 'anonymize_ip': true});
</script>

<script type="text/javascript" charset="UTF-8">
document.addEventListener('DOMContentLoaded', function () {
cookieconsent.run({
  "notice_banner_type":"simple",
  "consent_type":"implied",
  "palette":"light",
  "language":"en",
  "page_load_consent_levels":["strictly-necessary","functionality","tracking","targeting"],
  "notice_banner_reject_button_hide":false,
  "preferences_center_close_button_hide":false,
  "website_name":""
  });
});
</script> 
  

  <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script>

<meta name="twitter:title" content="Learning analytics methods and tutorials - 13&nbsp; Multi-channel sequence analysis in educational research: An introduction and tutorial with R">
<meta name="twitter:description" content="This chapter introduces multi-channel sequence analysis, a novel method that examines two or more synchronised sequences.">
<meta name="twitter:card" content="summary">
<meta name="citation_title" content="[13]{.chapter-number}&nbsp; [Multi-channel sequence analysis in educational research: An introduction and tutorial with R]{.chapter-title}">
<meta name="citation_abstract" content="This chapter introduces multi-channel sequence analysis, a novel method that examines two or more synchronised sequences. While this approach is relatively new in social sciences, its relevance to educational research is growing as researchers gain access to diverse multimodal temporal data. Throughout this chapter, we describe multi-channel sequence analysis in detail, with an emphasis on how to detect patterns within the sequences, i.e., clusters ---or trajectories--- of multi-channel sequences that share similar temporal evolutions (or similar trajectories). To illustrate this method we present a step-by-step tutorial in R that analyses students&amp;amp;#039; sequences of online engagement and academic achievement, exploring their longitudinal association. We cover two approaches for clustering multi-channel sequences: one based on using distance-based algorithms, and the other employing mixture hidden Markov models inspired by recent research.">
<meta name="citation_keywords" content="learning analytics, multichannel sequence analysis, mixture hidden markov models, multimodal data">
<meta name="citation_author" content="Sonsoles López-Pernas">
<meta name="citation_author" content="Mohammed Saqr">
<meta name="citation_author" content="Satu Helske">
<meta name="citation_author" content="Keefe Murphy">
<meta name="citation_fulltext_html_url" content="https://lamethods.github.io/chapters/ch13-multichannel/ch13-multi.html">
<meta name="citation_language" content="en">
<meta name="citation_reference" content="citation_title=Latent class models in longitudinal research;,citation_author=Jeroen K Vermunt;,citation_author=Bac Tran;,citation_author=Jay Magidson;,citation_publication_date=2008;,citation_cover_date=2008;,citation_year=2008;,citation_journal_title=Handbook of longitudinal research: Design, measurement, and analysis;">
<meta name="citation_reference" content="citation_title=Examples and tips for estimating markovian models with seqHMM;,citation_author=Satu Helske;,citation_publication_date=2017;,citation_cover_date=2017;,citation_year=2017;">
<meta name="citation_reference" content="citation_title=Visualization tools in the seqHMM package;,citation_author=Satu Helske;,citation_publication_date=2017;,citation_cover_date=2017;,citation_year=2017;">
<meta name="citation_reference" content="citation_title=Mixture hidden markov models for sequence data: The seqHMM package in r;,citation_author=Satu Helske;,citation_author=Jouni Helske;,citation_publication_date=2019;,citation_cover_date=2019;,citation_year=2019;,citation_volume=88;,citation_journal_title=Journal of Statistical Software;">
<meta name="citation_reference" content="citation_title=Sequence analysis;,citation_author=Marcel Raab;,citation_author=Emanuela Struffolino;,citation_publication_date=2022;,citation_cover_date=2022;,citation_year=2022;,citation_volume=190;">
<meta name="citation_reference" content="citation_title=Joint sequence analysis: Association and clustering;,citation_author=Raffaella Piccarreta;,citation_publication_date=2017;,citation_cover_date=2017;,citation_year=2017;,citation_issue=2;,citation_volume=46;,citation_journal_title=Sociological Methods &amp;amp;amp; Research;,citation_publisher=SAGE Publications Sage CA: Los Angeles, CA;">
<meta name="citation_reference" content="citation_title=Mining for association between life course domains;,citation_author=Raffaella Piccarreta;,citation_author=Cees H Elzinga;,citation_publication_date=2013;,citation_cover_date=2013;,citation_year=2013;,citation_inbook_title=Contemporary issues in exploratory data mining in the behavioral sciences;">
<meta name="citation_reference" content="citation_title=Life-course trajectories of employment quality and health in the U.S.: A multichannel sequence analysis;,citation_author=Jerzy Eisenberg-Guyot;,citation_author=Trevor Peckham;,citation_author=Sarah B. Andrea;,citation_author=Vanessa Oddo;,citation_author=Noah Seixas;,citation_author=Anjum Hajat;,citation_publication_date=2020-11;,citation_cover_date=2020-11;,citation_year=2020;,citation_fulltext_html_url=https://doi.org/10.1016/j.socscimed.2020.113327;,citation_doi=10.1016/j.socscimed.2020.113327;,citation_volume=264;,citation_journal_title=Social Science &amp;amp;amp; Medicine;,citation_publisher=Elsevier BV;">
<meta name="citation_reference" content="citation_title=Multichannel sequence analysis applied to social science data;,citation_author=Jacques-Antoine Gauthier;,citation_author=Eric D. Widmer;,citation_author=Philipp Bucher;,citation_author=Cédric Notredame;,citation_publication_date=2010-07;,citation_cover_date=2010-07;,citation_year=2010;,citation_fulltext_html_url=https://doi.org/10.1111/j.1467-9531.2010.01227.x;,citation_issue=1;,citation_doi=10.1111/j.1467-9531.2010.01227.x;,citation_volume=40;,citation_journal_title=Sociological Methodology;,citation_publisher=SAGE Publications;">
<meta name="citation_reference" content="citation_title=Comparison of two approaches in multichannel sequence analysis using the Swiss Household Panel;,citation_author=Kevin Emery;,citation_author=André Berchtold;,citation_publication_date=2022-12;,citation_cover_date=2022-12;,citation_year=2022;,citation_fulltext_html_url=https://doi.org/10.1332/175795921x16698302233894;,citation_doi=10.1332/175795921x16698302233894;,citation_journal_title=Longitudinal and Life Course Studies;,citation_publisher=Bristol University Press;">
<meta name="citation_reference" content="citation_title=The longitudinal association between engagement and achievement varies by time, students’ profiles, and achievement state: A full program study;,citation_author=Mohammed Saqr;,citation_author=Sonsoles López-Pernas;,citation_author=Satu Helske;,citation_author=Stefan Hrastinski;,citation_publication_date=2023-07;,citation_cover_date=2023-07;,citation_year=2023;,citation_fulltext_html_url=https://doi.org/10.1016/j.compedu.2023.104787;,citation_doi=10.1016/j.compedu.2023.104787;,citation_volume=199;,citation_journal_title=Computers &amp;amp;amp; Education;,citation_publisher=Elsevier BV;">
<meta name="citation_reference" content="citation_title=Modeling and predicting students’ engagement behaviors using mixture Markov models;,citation_author=Rabia Maqsood;,citation_author=Paolo Ceravolo;,citation_author=Cristóbal Romero;,citation_author=Sebastián Ventura;,citation_publication_date=2022-04;,citation_cover_date=2022-04;,citation_year=2022;,citation_fulltext_html_url=https://doi.org/10.1007/s10115-022-01674-9;,citation_issue=5;,citation_doi=10.1007/s10115-022-01674-9;,citation_volume=64;,citation_journal_title=Knowledge and Information Systems;,citation_publisher=Springer Science; Business Media LLC;">
<meta name="citation_reference" content="citation_title=A mixture hidden Markov model to mine students’ university curricula;,citation_author=Silvia Bacci;,citation_author=Bruno Bertaccini;,citation_publication_date=2022-02;,citation_cover_date=2022-02;,citation_year=2022;,citation_fulltext_html_url=https://doi.org/10.3390/data7020025;,citation_issue=2;,citation_doi=10.3390/data7020025;,citation_volume=7;,citation_journal_title=Data;,citation_publisher=MDPI AG;">
<meta name="citation_reference" content="citation_title=Recognizing multidimensional engagement of e-learners based on multi-channel data in e-learning environment;,citation_author=Jia Yue;,citation_author=Feng Tian;,citation_author=Kuo-Min Chao;,citation_author=Nazaraf Shah;,citation_author=Longzhuang Li;,citation_author=Yan Chen;,citation_author=Qinghua Zheng;,citation_publication_date=2019;,citation_cover_date=2019;,citation_year=2019;,citation_fulltext_html_url=https://doi.org/10.1109/access.2019.2947091;,citation_doi=10.1109/access.2019.2947091;,citation_volume=7;,citation_journal_title=IEEE Access;,citation_publisher=Institute of Electrical; Electronics Engineers (IEEE);">
<meta name="citation_reference" content="citation_title=Analysis and evaluation of the impact of integrating mental health education into the teaching of university civics courses in the context of artificial intelligence;,citation_author=JingJing Wu;,citation_editor=Kuruva Lakshmanna;,citation_publication_date=2022-08;,citation_cover_date=2022-08;,citation_year=2022;,citation_fulltext_html_url=https://doi.org/10.1155/2022/5378694;,citation_doi=10.1155/2022/5378694;,citation_volume=2022;,citation_journal_title=Wireless Communications and Mobile Computing;,citation_publisher=Hindawi Limited;">
<meta name="citation_reference" content="citation_title=Combining sequence analysis and hidden Markov models in the analysis of complex life sequence data;,citation_author=Satu Helske;,citation_author=Jouni Helske;,citation_author=Mervi Eerola;,citation_publication_date=2018;,citation_cover_date=2018;,citation_year=2018;,citation_fulltext_html_url=https://doi.org/10.1007/978-3-319-95420-2_11;,citation_doi=10.1007/978-3-319-95420-2_11;,citation_inbook_title=Life course research and social policies;">
<meta name="citation_reference" content="citation_title=A person-centered approach to study students’ socio-emotional interaction profiles and regulation of collaborative learning;,citation_author=Tiina Törmänen;,citation_author=Hanna Järvenoja;,citation_author=Mohammed Saqr;,citation_author=Jonna Malmberg;,citation_author=Sanna Järvelä;,citation_publication_date=2022-06;,citation_cover_date=2022-06;,citation_year=2022;,citation_fulltext_html_url=https://doi.org/10.3389/feduc.2022.866612;,citation_doi=10.3389/feduc.2022.866612;,citation_volume=7;,citation_journal_title=Frontiers in Education;,citation_publisher=Frontiers Media SA;">
<meta name="citation_reference" content="citation_title=Bringing synchrony and clarity to complex multi-channel data: A learning analytics study in programming education;,citation_author=Sonsoles Lopez-Pernas;,citation_author=Mohammed Saqr;,citation_publication_date=2021;,citation_cover_date=2021;,citation_year=2021;,citation_fulltext_html_url=https://doi.org/10.1109/access.2021.3134844;,citation_doi=10.1109/access.2021.3134844;,citation_volume=9;,citation_journal_title=IEEE Access;,citation_publisher=Institute of Electrical; Electronics Engineers (IEEE);">
<meta name="citation_reference" content="citation_title=An artificial intelligence-driven learning analytics method to examine the collaborative problem-solving process from the complex adaptive systems perspective;,citation_author=Fan Ouyang;,citation_author=Weiqi Xu;,citation_author=Mutlu Cukurova;,citation_publication_date=2023-03;,citation_cover_date=2023-03;,citation_year=2023;,citation_fulltext_html_url=https://doi.org/10.1007/s11412-023-09387-z;,citation_issue=1;,citation_doi=10.1007/s11412-023-09387-z;,citation_volume=18;,citation_journal_title=International Journal of Computer-Supported Collaborative Learning;,citation_publisher=Springer Science; Business Media LLC;">
<meta name="citation_reference" content="citation_title=Affective states and regulation of learning during socio-emotional interactions in secondary school collaborative groups;,citation_author=Tiina Törmänen;,citation_author=Hanna Järvenoja;,citation_author=Mohammed Saqr;,citation_author=Jonna Malmberg;,citation_author=Sanna Järvelä;,citation_publication_date=2022-06;,citation_cover_date=2022-06;,citation_year=2022;,citation_fulltext_html_url=https://doi.org/10.1111/bjep.12525;,citation_issue=S1;,citation_doi=10.1111/bjep.12525;,citation_volume=93;,citation_journal_title=British Journal of Educational Psychology;,citation_publisher=Wiley;">
<meta name="citation_reference" content="citation_title=mclust 5: Clustering, classification and density estimation using Gaussian finite mixture models;,citation_author=Luca Scrucca;,citation_author=Michael Fop;,citation_author=T. Brendan Murphy;,citation_author=Adrian E. Raftery;,citation_publication_date=2016;,citation_cover_date=2016;,citation_year=2016;,citation_fulltext_html_url=https://doi.org/10.32614/RJ-2016-021;,citation_issue=1;,citation_volume=8;,citation_journal_title=The R Journal;">
<meta name="citation_reference" content="citation_title=Welcome to the tidyverse;,citation_author=Hadley Wickham;,citation_author=Mara Averick;,citation_author=Jennifer Bryan;,citation_author=Winston Chang;,citation_author=Lucy D’Agostino McGowan;,citation_author=Romain François;,citation_author=Garrett Grolemund;,citation_author=Alex Hayes;,citation_author=Lionel Henry;,citation_author=Jim Hester;,citation_author=Max Kuhn;,citation_author=Thomas Lin Pedersen;,citation_author=Evan Miller;,citation_author=Stephan Milton Bache;,citation_author=Kirill Müller;,citation_author=Jeroen Ooms;,citation_author=David Robinson;,citation_author=Dana Paige Seidel;,citation_author=Vitalie Spinu;,citation_author=Kohske Takahashi;,citation_author=Davis Vaughan;,citation_author=Claus Wilke;,citation_author=Kara Woo;,citation_author=Hiroaki Yutani;,citation_publication_date=2019;,citation_cover_date=2019;,citation_year=2019;,citation_issue=43;,citation_doi=10.21105/joss.01686;,citation_volume=4;,citation_journal_title=Journal of Open Source Software;">
<meta name="citation_reference" content="citation_title=Rio: A Swiss-army knife for data file I/O;,citation_author=Chung-hong Chan;,citation_author=Geoffrey CH Chan;,citation_author=Thomas J. Leeper;,citation_author=Jason Becker;,citation_publication_date=2021;,citation_cover_date=2021;,citation_year=2021;">
<meta name="citation_reference" content="citation_title=seqHMM: Mixture hidden Markov models for social sequence data and other multivariate, multichannel categorical time series;,citation_author=Jouni Helske;,citation_author=Satu Helske;,citation_publication_date=2023;,citation_cover_date=2023;,citation_year=2023;,citation_fulltext_html_url=https://cran.r-project.org/package=seqHMM;">
<meta name="citation_reference" content="citation_title=Time for change: Why learning analytics needs temporal analysis;,citation_author=Simon Knight;,citation_author=Alyssa Friend Wise;,citation_author=Bodong Chen;,citation_publication_date=2017-12;,citation_cover_date=2017-12;,citation_year=2017;,citation_fulltext_html_url=https://doi.org/10.18608/jla.2017.43.2;,citation_issue=3;,citation_doi=10.18608/jla.2017.43.2;,citation_volume=4;,citation_journal_title=Journal of Learning Analytics;,citation_publisher=Society for Learning Analytics Research;">
<meta name="citation_reference" content="citation_title=Time to focus on the temporal dimension of learning: A learning analytics study of the temporal patterns of students’ interactions and self-regulation;,citation_author=Mohammed Saqr;,citation_author=Jalal Nouri;,citation_author=Uno Fors;,citation_publication_date=2019;,citation_cover_date=2019;,citation_year=2019;,citation_fulltext_html_url=https://doi.org/10.1504/ijtel.2019.102549;,citation_issue=4;,citation_doi=10.1504/ijtel.2019.102549;,citation_volume=11;,citation_journal_title=International Journal of Technology Enhanced Learning;,citation_publisher=Inderscience Publishers;">
<meta name="citation_reference" content="citation_title=Mixture hidden Markov models for sequence data: The seqHMM package in R;,citation_author=Satu Helske;,citation_author=Jouni Helske;,citation_publication_date=2019;,citation_cover_date=2019;,citation_year=2019;,citation_fulltext_html_url=https://doi.org/10.18637/jss.v088.i03;,citation_issue=3;,citation_doi=10.18637/jss.v088.i03;,citation_volume=88;,citation_journal_title=Journal of Statistical Software;,citation_publisher=Foundation for Open Access Statistic;">
<meta name="citation_reference" content="citation_title=Analyzing and visualizing state sequences in R with TraMineR;,citation_author=Alexis Gabadinho;,citation_author=Gilbert Ritschard;,citation_author=Nicolas S. Müller;,citation_author=Matthias Studer;,citation_publication_date=2011;,citation_cover_date=2011;,citation_year=2011;,citation_fulltext_html_url=https://doi.org/10.18637/jss.v040.i04;,citation_issue=4;,citation_doi=10.18637/jss.v040.i04;,citation_volume=40;,citation_journal_title=Journal of Statistical Software;,citation_publisher=Foundation for Open Access Statistic;">
<meta name="citation_reference" content="citation_title=BBmisc: Miscellaneous helper functions for B. Bischl;,citation_author=Bernd Bischl;,citation_author=Michel Lang;,citation_author=Jakob Bossek;,citation_author=Daniel Horn;,citation_author=Jakob Richter;,citation_author=Dirk Surmann;,citation_publication_date=2022;,citation_cover_date=2022;,citation_year=2022;,citation_fulltext_html_url=https://CRAN.R-project.org/package=BBmisc;">
<meta name="citation_reference" content="citation_title=The temporal dynamics of online problem-based learning: Why and when sequence matters;,citation_author=Mohammed Saqr;,citation_author=Sonsoles López-Pernas;,citation_publication_date=2023;,citation_cover_date=2023;,citation_year=2023;,citation_issue=1;,citation_doi=10.1007/s11412-023-09385-1;,citation_volume=18;,citation_journal_title=International Journal of Computer-Supported Collaborative Learning;">
<meta name="citation_reference" content="citation_title=Holistic trajectories: A study of combined employment, housing and family careers by using multiple-sequence analysis;,citation_author=Gary Pollock;,citation_publication_date=2007;,citation_cover_date=2007;,citation_year=2007;,citation_fulltext_html_url=https://www.jstor.org/stable/4623140;,citation_issue=1;,citation_volume=170;,citation_journal_title=Journal of the Royal Statistical Society: Series A (Statistics in Society);">
<meta name="citation_reference" content="citation_title=Estimating the dimension of a model;,citation_author=Gideon E Schwarz;,citation_publication_date=1978;,citation_cover_date=1978;,citation_year=1978;,citation_issue=2;,citation_doi=10.1214/aos/1176344136;,citation_volume=6;,citation_journal_title=The Annals of Statistics;,citation_publisher=The Institute of Mathematical Statistics;">
<meta name="citation_reference" content="citation_title=Strategies for multidomain sequence analyis in social research;,citation_author=Gilbert Ritschard;,citation_author=Tim Futing Liao;,citation_author=Emanuela Struffolino;,citation_publication_date=2023;,citation_cover_date=2023;,citation_year=2023;,citation_doi=10.1177/0081175023116383;,citation_volume=53;,citation_journal_title=Sociological Methodology;">
<meta name="citation_reference" content="citation_title=Disentangling time use, food environment, and food behaviors using multi-channel sequence analysis;,citation_author=Bochu Liu;,citation_author=Michael J. Widener;,citation_author=Lindsey G. Smith;,citation_author=Steven Farber;,citation_author=Leia M. Minaker;,citation_author=Zachary Patterson;,citation_author=Kristian Larsen;,citation_author=Jason Gilliland;,citation_publication_date=2021-10;,citation_cover_date=2021-10;,citation_year=2021;,citation_fulltext_html_url=https://doi.org/10.1111/gean.12305;,citation_issue=4;,citation_doi=10.1111/gean.12305;,citation_volume=54;,citation_journal_title=Geographical Analysis;,citation_publisher=Wiley;">
<meta name="citation_reference" content="citation_title=WeightedCluster library manual: A practical guide to creating typologies of trajectories in the social sciences with R;,citation_author=Matthias Studer;,citation_publication_date=2013;,citation_cover_date=2013;,citation_year=2013;,citation_fulltext_html_url=https://www.centre-lives.ch/fr/bibcite/reference/84;,citation_doi=10.12682/LIVES.2296-1658.2013.24;,citation_journal_title=LIVES;">
<meta name="citation_reference" content="citation_title=Concomitant-variable latent-class models;,citation_author=C. M. Dayton;,citation_author=G. B. Macready;,citation_publication_date=1988;,citation_cover_date=1988;,citation_year=1988;,citation_issue=401;,citation_volume=83;,citation_journal_title=Journal of the American Statistical Association;">
<meta name="citation_reference" content="citation_title=Gaussian parsimonious clustering models with covariates and a noise component;,citation_author=K. Murphy;,citation_author=T. B. Murphy;,citation_publication_date=2020;,citation_cover_date=2020;,citation_year=2020;,citation_issue=2;,citation_volume=14;,citation_journal_title=Advances in Data Analysis and Classification;">
<meta name="citation_reference" content="citation_title=Clustering longitudinal life-course sequences using mixtures of exponential-distance models;,citation_author=K. Murphy;,citation_author=T. B. Murphy;,citation_author=R. Piccarreta;,citation_author=Gormley I. C.;,citation_publication_date=2021;,citation_cover_date=2021;,citation_year=2021;,citation_issue=4;,citation_volume=184;,citation_journal_title=Journal of the Royal Statistical Society: Seria A (Statistics in Society);">
<meta name="citation_reference" content="citation_title=From sequences to variables: Rethinking the relationship between sequences and outcomes;,citation_author=Satu Helske;,citation_author=Jouni Helske;,citation_author=Guilherme K Chihaya;,citation_publication_date=2023-06;,citation_cover_date=2023-06;,citation_year=2023;,citation_fulltext_html_url=https://doi.org/10.1177/00811750231177026;,citation_doi=10.1177/00811750231177026;,citation_issn=0081-1750;,citation_journal_title=Sociol. Methodol.;,citation_publisher=SAGE Publications Inc;">
<meta name="citation_reference" content="citation_title=Divisive Property-Based and fuzzy clustering for sequence analysis;,citation_author=Matthias Studer;,citation_editor=Gilbert Ritschard;,citation_editor=Matthias Studer;,citation_publication_date=2018;,citation_cover_date=2018;,citation_year=2018;,citation_fulltext_html_url=https://doi.org/10.1007/978-3-319-95420-2_13;,citation_doi=10.1007/978-3-319-95420-2\_13;,citation_isbn=9783319954202;,citation_inbook_title=Sequence analysis and related approaches: Innovative methods and applications;">
<meta name="citation_reference" content="citation_title=Sequence analysis in education: Principles, technique, and tutorial with r;,citation_author=Mohammed Saqr;,citation_author=Sonsoles López-Pernas;,citation_author=Satu Helske;,citation_author=Marion Durand;,citation_author=Keefe Murphy;,citation_author=Matthias Studer;,citation_author=Gilbert Ritschard;,citation_editor=Mohammed Saqr;,citation_editor=Sonsoles López-Pernas;,citation_publication_date=2024;,citation_cover_date=2024;,citation_year=2024;,citation_inbook_title=Learning analytics methods and tutorials: A practical guide using R;">
<meta name="citation_reference" content="citation_title=Modeling the dynamics of longitudinal processes in education. A tutorial with r for the VaSSTra method;,citation_author=Sonsoles López-Pernas;,citation_author=Mohammed Saqr;,citation_editor=Mohammed Saqr;,citation_editor=Sonsoles López-Pernas;,citation_publication_date=2024;,citation_cover_date=2024;,citation_year=2024;,citation_inbook_title=Learning analytics methods and tutorials: A practical guide using R;">
<meta name="citation_reference" content="citation_title=A modern approach to transition analysis and process mining with markov models: A tutorial with R;,citation_author=Jouni Helske;,citation_author=Satu Helske;,citation_author=Mohammed Saqr;,citation_author=Sonsoles López-Pernas;,citation_author=Keefe Murphy;,citation_editor=Mohammed Saqr;,citation_editor=Sonsoles López-Pernas;,citation_publication_date=2024;,citation_cover_date=2024;,citation_year=2024;,citation_inbook_title=Learning analytics methods and tutorials: A practical guide using R;">
<meta name="citation_reference" content="citation_title=Efficient agglomerative hierarchical clustering;,citation_author=Athman Bouguettaya;,citation_author=Qi Yu;,citation_author=Xumin Liu;,citation_author=Xiangmin Zhou;,citation_author=Andy Song;,citation_publication_date=2015;,citation_cover_date=2015;,citation_year=2015;,citation_issue=5;,citation_doi=https://doi.org/10.1016/j.eswa.2014.09.054;,citation_issn=0957-4174;,citation_volume=42;,citation_journal_title=Expert Systems with Applications;">
<meta name="citation_reference" content="citation_title=Efficient hierarchical clustering of large high dimensional datasets;,citation_author=Sean Gilpin;,citation_author=Buyue Qian;,citation_author=Ian Davidson;,citation_publication_date=2013;,citation_cover_date=2013;,citation_year=2013;,citation_fulltext_html_url=https://doi.org/10.1145/2505515.2505527;,citation_doi=10.1145/2505515.2505527;,citation_isbn=9781450322638;,citation_conference_title=Proceedings of the 22nd ACM international conference on information &amp;amp;amp; knowledge management;,citation_conference=Association for Computing Machinery;,citation_series_title=CIKM ’13;">
<meta name="citation_reference" content="citation_title=Intense, turbulent, or wallowing in the mire: A longitudinal study of cross-course online tactics, strategies, and trajectories;,citation_abstract=Research has repeatedly demonstrated that students with effective learning strategies are more likely to have better academic achievement. Existing research has mostly focused on a single course or two, while longitudinal studies remain scarce. The present study examines the longitudinal sequence of students’ strategies, their succession, consistency, temporal unfolding, and whether students tend to retain or adapt strategies between courses. We use a large dataset of online traces from 135 students who completed 10 successive courses (i.e., 1350 course enrollments) in a higher education program. The methods used in this study have shown the feasibility of using trace data recorded by learning management systems to unobtrusively trace and model the longitudinal learning strategies across a program. We identified three program-level strategy trajectories: a stable and intense trajectory related to deep learning where students used diverse strategies and scored the highest grades; a fluctuating interactive trajectory, where students focused on course requirements, scored average grades, and were relatively fluctuating; and a light trajectory related to surface learning where students invested the least effort, scored the lowest grades, and had a relatively stable pathway. Students who were intensely active were more likely to transfer the intense strategies and therefore, they were expected to require less support or guidance. Students focusing on course requirements were not as effective self-regulators as they seemed and possibly required early guidance and support from teachers. Students with consistent light strategies or low effort needed proactive guidance and support.;,citation_author=Mohammed Saqr;,citation_author=Sonsoles López-Pernas;,citation_author=Jelena Jovanović;,citation_author=Dragan Gašević;,citation_publication_date=2023;,citation_cover_date=2023;,citation_year=2023;,citation_volume=57;,citation_journal_title=The Internet and Higher Education;">
<meta name="citation_reference" content="citation_title=Construct and consequential validity for learning analytics based on trace data;,citation_author=Philip H. Winne;,citation_publication_date=2020-11;,citation_cover_date=2020-11;,citation_year=2020;,citation_fulltext_html_url=https://doi.org/10.1016/j.chb.2020.106457;,citation_doi=10.1016/j.chb.2020.106457;,citation_volume=112;,citation_journal_title=Computers in Human Behavior;,citation_publisher=Elsevier BV;">
<meta name="citation_reference" content="citation_title=A tutorial on hidden Markov models and selected applications in speech recognition;,citation_author=L. R. Rabiner;,citation_publication_date=1989;,citation_cover_date=1989;,citation_year=1989;,citation_issue=2;,citation_doi=10.1109/5.18626;,citation_volume=77;,citation_journal_title=Proceedings of the IEEE;">
<meta name="citation_reference" content="citation_title=Latent class models in longitudinal research;,citation_author=Jeroen K Vermunt;,citation_author=Bac Tran;,citation_author=Jay Magidson;,citation_publication_date=2008;,citation_cover_date=2008;,citation_year=2008;,citation_journal_title=Handbook of longitudinal research: Design, measurement, and analysis;">
</head>

<body class="nav-sidebar floating">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
  <nav class="quarto-secondary-nav" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
    <div class="container-fluid d-flex justify-content-between">
      <h1 class="quarto-secondary-nav-title"><span class="chapter-number">13</span>&nbsp; <span class="chapter-title">Multi-channel sequence analysis in educational research: An introduction and tutorial with R</span></h1>
      <button type="button" class="quarto-btn-toggle btn" aria-label="Show secondary navigation">
        <i class="bi bi-chevron-right"></i>
      </button>
    </div>
  </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse sidebar-navigation floating overflow-auto">
    <div class="pt-lg-2 mt-2 text-left sidebar-header">
    <div class="sidebar-title mb-0 py-0">
      <a href="../../">Learning analytics methods and tutorials</a> 
        <div class="sidebar-tools-main">
    <a href="https://github.com/lamethods/labook-code/" title="Source Code" class="sidebar-tool px-1"><i class="bi bi-github"></i></a>
</div>
    </div>
      </div>
      <div class="mt-2 flex-shrink-0 align-items-center">
        <div class="sidebar-search">
        <div id="quarto-search" class="" title="Search"></div>
        </div>
      </div>
    <div class="sidebar-menu-container"> 
    <ul class="list-unstyled mt-1">
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../index.html" class="sidebar-item-text sidebar-link">Welcome</a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../contributors.html" class="sidebar-item-text sidebar-link">Contributors</a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../chapters/ch01-intro/intro.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">1</span>&nbsp; <span class="chapter-title">Introduction</span></a>
  </div>
</li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" aria-expanded="true">Getting started</a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" aria-expanded="true">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-1" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../chapters/ch02-data/ch2-data.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">2</span>&nbsp; <span class="chapter-title">Data</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../chapters/ch03-intro-r/ch3-intor.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">3</span>&nbsp; <span class="chapter-title">Intro to R</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../chapters/ch04-data-cleaning/ch4-datacleaning.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">4</span>&nbsp; <span class="chapter-title">Data cleaning</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../chapters/ch05-basic-stats/ch5-stats.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">5</span>&nbsp; <span class="chapter-title">Basic statistics</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../chapters/ch06-data-visualization/ch6-viz.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">6</span>&nbsp; <span class="chapter-title">Data visualization</span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-2" aria-expanded="true">Machine Learning</a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-2" aria-expanded="true">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-2" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../chapters/ch07-prediction/ch7-pred.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">7</span>&nbsp; <span class="chapter-title">Predictive modeling</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../chapters/ch08-clustering/ch8-clus.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">8</span>&nbsp; <span class="chapter-title">Dissimilarity-based Clustering</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../chapters/ch09-model-based-clustering/ch9-model.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">9</span>&nbsp; <span class="chapter-title">Model-based clustering</span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-3" aria-expanded="true">Temporal methods</a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-3" aria-expanded="true">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-3" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../chapters/ch10-sequence-analysis/ch10-seq.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">10</span>&nbsp; <span class="chapter-title">Sequence analysis</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../chapters/ch11-vasstra/ch11-vasstra.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">11</span>&nbsp; <span class="chapter-title">VaSSTra</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../chapters/ch12-markov/ch12-markov.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">12</span>&nbsp; <span class="chapter-title">Markov models</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../chapters/ch13-multichannel/ch13-multi.html" class="sidebar-item-text sidebar-link active"><span class="chapter-number">13</span>&nbsp; <span class="chapter-title">Multi-channel sequences</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../chapters/ch14-process-mining/ch14-process.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">14</span>&nbsp; <span class="chapter-title">Process mining</span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-4" aria-expanded="true">Network analysis</a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-4" aria-expanded="true">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-4" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../chapters/ch15-sna/ch15-sna.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">15</span>&nbsp; <span class="chapter-title">Social Network Analysis</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../chapters/ch16-community/ch16-comm.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">16</span>&nbsp; <span class="chapter-title">Community detection</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../chapters/ch17-temporal-networks/ch17-tna.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">17</span>&nbsp; <span class="chapter-title">Temporal Networks</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../chapters/ch18-ena-ona/ch18-ena.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">18</span>&nbsp; <span class="chapter-title">Epistemic Network Analysis</span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-5" aria-expanded="true">Psychometrics</a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-5" aria-expanded="true">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-5" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../chapters/ch19-psychological-networks/ch19-psych.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">19</span>&nbsp; <span class="chapter-title">Psychological networks</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../chapters/ch20-factor-analysis/ch20-factor.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">20</span>&nbsp; <span class="chapter-title">Factor analysis</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../chapters/ch21-sem/ch21-sem.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">21</span>&nbsp; <span class="chapter-title">Structured Equation Modeling</span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../chapters/ch22-conclusion/ch22-conclusion.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">22</span>&nbsp; <span class="chapter-title">Conclusion</span></a>
  </div>
</li>
    </ul>
    </div>
</nav>
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">Table of contents</h2>
   
  <ul>
  <li><a href="#introduction" id="toc-introduction" class="nav-link active" data-scroll-target="#introduction"><span class="toc-section-number">1</span>  Introduction</a></li>
  <li><a href="#multi-channel-sequence-analysis" id="toc-multi-channel-sequence-analysis" class="nav-link" data-scroll-target="#multi-channel-sequence-analysis"><span class="toc-section-number">2</span>  Multi-channel sequence analysis</a>
  <ul class="collapse">
  <li><a href="#step-1-building-the-channel-sequences" id="toc-step-1-building-the-channel-sequences" class="nav-link" data-scroll-target="#step-1-building-the-channel-sequences"><span class="toc-section-number">2.1</span>  Step 1: Building the channel sequences</a></li>
  <li><a href="#step-2-visualising-the-multi-channel-sequence" id="toc-step-2-visualising-the-multi-channel-sequence" class="nav-link" data-scroll-target="#step-2-visualising-the-multi-channel-sequence"><span class="toc-section-number">2.2</span>  Step 2: Visualising the multi-channel sequence</a></li>
  <li><a href="#step-3-finding-patterns-clusters-or-trajectories" id="toc-step-3-finding-patterns-clusters-or-trajectories" class="nav-link" data-scroll-target="#step-3-finding-patterns-clusters-or-trajectories"><span class="toc-section-number">2.3</span>  Step 3: Finding patterns (clusters or trajectories)</a></li>
  <li><a href="#covariates" id="toc-covariates" class="nav-link" data-scroll-target="#covariates"><span class="toc-section-number">2.4</span>  Step 4: Relating clusters to covariates</a></li>
  </ul></li>
  <li><a href="#review-of-the-literature" id="toc-review-of-the-literature" class="nav-link" data-scroll-target="#review-of-the-literature"><span class="toc-section-number">3</span>  Review of the literature</a></li>
  <li><a href="#case-study-the-longitudinal-association-of-engagement-and-achievement" id="toc-case-study-the-longitudinal-association-of-engagement-and-achievement" class="nav-link" data-scroll-target="#case-study-the-longitudinal-association-of-engagement-and-achievement"><span class="toc-section-number">4</span>  Case study: the longitudinal association of engagement and achievement</a>
  <ul class="collapse">
  <li><a href="#the-packages" id="toc-the-packages" class="nav-link" data-scroll-target="#the-packages"><span class="toc-section-number">4.1</span>  The packages</a></li>
  <li><a href="#the-data" id="toc-the-data" class="nav-link" data-scroll-target="#the-data"><span class="toc-section-number">4.2</span>  The data</a></li>
  <li><a href="#creating-the-sequences" id="toc-creating-the-sequences" class="nav-link" data-scroll-target="#creating-the-sequences"><span class="toc-section-number">4.3</span>  Creating the sequences</a></li>
  <li><a href="#clustering-via-multi-channel-dissimilarities" id="toc-clustering-via-multi-channel-dissimilarities" class="nav-link" data-scroll-target="#clustering-via-multi-channel-dissimilarities"><span class="toc-section-number">4.4</span>  Clustering via multi-channel dissimilarities</a></li>
  <li><a href="#building-a-mixture-hidden-markov-model" id="toc-building-a-mixture-hidden-markov-model" class="nav-link" data-scroll-target="#building-a-mixture-hidden-markov-model"><span class="toc-section-number">4.5</span>  Building a mixture hidden Markov model</a></li>
  <li><a href="#incorporating-covariates-in-mhmms" id="toc-incorporating-covariates-in-mhmms" class="nav-link" data-scroll-target="#incorporating-covariates-in-mhmms"><span class="toc-section-number">4.6</span>  Incorporating covariates in MHMMs</a></li>
  </ul></li>
  <li><a href="#discussion" id="toc-discussion" class="nav-link" data-scroll-target="#discussion"><span class="toc-section-number">5</span>  Discussion</a></li>
  <li><a href="#further-readings" id="toc-further-readings" class="nav-link" data-scroll-target="#further-readings"><span class="toc-section-number">6</span>  Further readings</a></li>
  <li><a href="#acknowledgements" id="toc-acknowledgements" class="nav-link" data-scroll-target="#acknowledgements"><span class="toc-section-number">7</span>  Acknowledgements</a></li>
  <li><a href="#bibliography" id="toc-bibliography" class="nav-link" data-scroll-target="#bibliography">References</a></li>
  </ul>
</nav>
    <div class="quarto-margin-footer"><div class="margin-footer-item">
<p><small>© 2023 The authors</small></p>
</div></div></div>
<!-- main -->
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title d-none d-lg-block"><span class="chapter-number">13</span>&nbsp; <span class="chapter-title">Multi-channel sequence analysis in educational research: An introduction and tutorial with R</span></h1>
</div>



<div class="quarto-title-meta">

    <div>
    <div class="quarto-title-meta-heading">Authors</div>
    <div class="quarto-title-meta-contents">
             <p>Sonsoles López-Pernas </p>
             <p>Mohammed Saqr </p>
             <p>Satu Helske </p>
             <p>Keefe Murphy </p>
          </div>
  </div>
    
  
    
  </div>
  
<div>
  <div class="abstract">
    <div class="abstract-title">Abstract</div>
    This chapter introduces multi-channel sequence analysis, a novel method that examines two or more synchronised sequences. While this approach is relatively new in social sciences, its relevance to educational research is growing as researchers gain access to diverse multimodal temporal data. Throughout this chapter, we describe multi-channel sequence analysis in detail, with an emphasis on how to detect patterns within the sequences, i.e., clusters —or trajectories— of multi-channel sequences that share similar temporal evolutions (or similar trajectories). To illustrate this method we present a step-by-step tutorial in R that analyses students’ sequences of online engagement and academic achievement, exploring their longitudinal association. We cover two approaches for clustering multi-channel sequences: one based on using distance-based algorithms, and the other employing mixture hidden Markov models inspired by recent research.
  </div>
</div>

</header>

<section id="introduction" class="level2" data-number="1">
<h2 data-number="1" class="anchored" data-anchor-id="introduction"><span class="header-section-number">1</span> Introduction</h2>
<p>Learning is a dynamic phenomenon which follows the unidirectional forward law of time; that is, learning occurs sequentially in a time-ordered manner <span class="citation" data-cites="Saqr2019 saqr2023temporal">[<a href="../ch01-intro/intro.html#ref-Saqr2019" role="doc-biblioref">1</a>, <a href="../ch01-intro/intro.html#ref-saqr2023temporal" role="doc-biblioref">2</a>]</span>. Throughout this book, we have devoted several chapters to sequence analysis of learner-related data, due to its increasingly central role in learning analytics and education research as a whole. First, in Chapter 10 <span class="citation" data-cites="Saqr2024-tv">[<a href="../ch01-intro/intro.html#ref-Saqr2024-tv" role="doc-biblioref">3</a>]</span>, we presented an introduction to sequence analysis and a discussion on the relevance of this method. Subsequently, in Chapter 11 <span class="citation" data-cites="Lopez-Pernas2024-lz">[<a href="../ch01-intro/intro.html#ref-Lopez-Pernas2024-lz" role="doc-biblioref">4</a>]</span>, we studied how to build sequences from multiple variables and analyse more complex aspects of sequences. Both Chapter 10 and Chapter 11 also deal with clustering sequences into trajectories which undergo a similar evolution using distance-based methods. Then, in Chapter 12 <span class="citation" data-cites="Helske2024-lq">[<a href="../ch01-intro/intro.html#ref-Helske2024-lq" role="doc-biblioref">5</a>]</span>, we learned how to cluster sequential data using Markov models. Though Chapter 12} <span class="citation" data-cites="Helske2024-lq">[<a href="../ch01-intro/intro.html#ref-Helske2024-lq" role="doc-biblioref">5</a>]</span> touched briefly on simultaneous analysis of multi-channel sequences —albeit only from the Markovian point of view— we present the multi-channel perspective in greater detail here.</p>
<p>In this new chapter, we cover multi-channel sequence analysis, which deals with the analysis of two or more synchronised sequences, in greater detail. An example in educational research would be the analysis of the simultaneous unfolding of motivation, achievement, and engament sequences. Multi-channel sequence analysis is a rather novel method in social sciences <span class="citation" data-cites="Helske2018 EisenbergGuyot2020 Emery2022 Gauthier2010">[<a href="../ch01-intro/intro.html#ref-Helske2018" role="doc-biblioref">6</a>–<a href="../ch01-intro/intro.html#ref-Gauthier2010" role="doc-biblioref">9</a>]</span> and its applications within educational research in general remain scarce. The increasing availability of student multimodal temporal data makes multi-channel sequence analysis a relevant and timely method to tackle the challenges that these new data bring.</p>
<p>Throughout this chapter, we describe multi-channel sequence analysis in detail, with an emphasis on how to detect patterns within the sequences, i.e., clusters —or trajectories— of multi-channel sequences that share similar temporal evolutions (or similar trajectories). We illustrate the method with a case study in which we examine students’ sequences of online engagement and academic achievement, where we analyse the longitudinal association between both constructs simultaneously. Here, we outline two perspectives on clustering multi-channel sequences and present both in the tutorial. The first approach uses distance-based clustering algorithms, very much in the spirit of the single-channel cluster analysis described in Chapter 10. We describe some limitations of this framework and then principally focus on a more efficient approach to identifying distinct trajectories using mixture hidden Markov models. We also show how covariates can be incorporated to make the Markovian framework even more powerful. This main analysis is inspired by the recently published paper by <span class="citation" data-cites="Saqr2023">[<a href="../ch01-intro/intro.html#ref-Saqr2023" role="doc-biblioref">10</a>]</span>. In the next section, we provide a description of the multi-channel sequence analysis framework. We follow with a review of the existing literature in learning analytics that has relied on multi-channel sequence analysis. Next, we include a step-by-step tutorial on how to implement multi-channel sequence analysis with R, with particular attention paid to clustering via distance-based algorithms and mixture hidden Markov models. Finally, we conclude with a brief discussion and provide recommendations for further reading.</p>
</section>
<section id="multi-channel-sequence-analysis" class="level2" data-number="2">
<h2 data-number="2" class="anchored" data-anchor-id="multi-channel-sequence-analysis"><span class="header-section-number">2</span> Multi-channel sequence analysis</h2>
<p>Multi-channel sequence analysis refers to the process of analysing sequential data that consists of multiple parallel channels or streams of (categorical) information. Each channel provides a different perspective or type of information. The goal of multi-channel sequence analysis is to jointly explore the dependencies and temporal interactions between the different channels and extract meaningful insights that may not be evident when considering each channel in isolation. The sources of information can be of very varied nature. For example, using video data of students working on a collaborative task, we could code students’ spoken utterances in one channel, and their facial expressions in another channel throughout the whole session (see <a href="#fig-multi">Figure&nbsp;<span>13.1</span></a>). In this way, we could analyse how students’ expressions relate to what they are saying. Multi-channel sequence analysis often follows the following steps:</p>
<div id="fig-multi" class="quarto-figure quarto-figure-center anchored">
<figure class="figure">
<p><img src="multichannel.png" class="img-fluid figure-img"></p>
<p></p><figcaption class="figure-caption"><strong>Figure</strong>&nbsp;1<strong>.</strong> An example of two channels of sequence data where the first channel (top) represents students’ utterances in collaborative work and the second channel (bottom) represents their facial expressions.</figcaption><p></p>
</figure>
</div>
<section id="step-1-building-the-channel-sequences" class="level3" data-number="2.1">
<h3 data-number="2.1" class="anchored" data-anchor-id="step-1-building-the-channel-sequences"><span class="header-section-number">2.1</span> Step 1: Building the channel sequences</h3>
<p>Just like in regular sequence analysis (see Chapter 10 <span class="citation" data-cites="Saqr2024-tv">[<a href="../ch01-intro/intro.html#ref-Saqr2024-tv" role="doc-biblioref">3</a>]</span>), the first step in multi-channel sequence analysis is to construct the sequences which constitute the different channels. A sequence is an ordered list of categorical elements (i.e., events, states or categories). These elements are discrete (as opposed to numerical values such as grades) and are ordered chronologically. In a sequence, time is not a continuum but a succession of discrete timepoints. These timepoints can be generated by sampling (e.g., each 30 seconds constitutes a new timepoint) or can emerge from an existing time scheme (e.g., each new lesson in a course is a new timepoint). In multi-channel sequence analysis, it is very important that all channels (i.e., parallel sequences) follow the same time scheme so they can be synchronised. As well as time points being aligned in this fashion, it is also typically assumed that the sequence length for each observation matches across channels (although some of the methods used can also deal with partially missing information). The elements of each sequence —typically referred to as the <em>alphabet</em>, which is unique for each channel— can be predefined events or categories from the beginning (e.g., utterances or facial expressions) or, in cases where we are dealing with numerical variables (e.g., heart rate or grades), we can convert them into a state or category by dividing the numerical variable into levels (e.g., tertiles, quartiles) or using clustering techniques. This way, we can focus on sharp changes in numerical variables and conceal small, probably insignificant changes. As Winne puts it <span class="citation" data-cites="Winne2020">[<a href="../ch01-intro/intro.html#ref-Winne2020" role="doc-biblioref">11</a>]</span>, “reliability can sometimes be improved by tuning grain size of data so it is neither too coarse, masking variance within bins, nor too fine-grained, inviting distinctions that cannot be made reliably”. Once we have our channels represented as sequences of ordered elements that follow the same time scheme, we can use the steps learned in the introductory sequence analysis chapter to construct the sequences.</p>
</section>
<section id="step-2-visualising-the-multi-channel-sequence" class="level3" data-number="2.2">
<h3 data-number="2.2" class="anchored" data-anchor-id="step-2-visualising-the-multi-channel-sequence"><span class="header-section-number">2.2</span> Step 2: Visualising the multi-channel sequence</h3>
<p>When we have built the sequences corresponding to all of the channels, we can visualise the data. Visualizing multi-channel sequence data is not a straightforward task, and we need to decide whether we want to present each channel separately or extend the alphabet to show a plot of combined states—or sometimes even both. The extended alphabet approach —in which the states are the combination of the states of all the channels— helps us understand the structure of the data and the typical combinations and evolution of the combined states from all of the channels. It usually works well when (1) the extended alphabet is moderate in size, (2) when there are no state combinations that are very rare, and (3) when the states are either fully observed or missing in all channels at the same time. The extended alphabet is likely to be of moderate size when there are at most 2–3 channels with a small alphabet in each, or if some combinations are not present in the data. Rare state combinations are typically impractical both when visualizing and analyzing the data—especially if there are many rare combinations or if the data are very sensitive in nature. Finally, if there are partially missing observations, i.e., observations that at some specific time point are missing from some of the channels but not all, we would need to deal with each combination of missing and observed states separately, which further extends the alphabet. If one or more of the three conditions are not met, it is often preferable to resort to presenting each channel separately or using visualization techniques that summarise information (e.g., sequence distribution plots).</p>
<p>Continuing with the previous example, the possible states in the extended alphabet would be all the combinations between the alphabet of the utterances channel (Question-Argument-Agreement) and the alphabet of the facial expressions channel (Happy-Neutral-Anxious). In <a href="#fig-multi2">Figure&nbsp;<span>13.2</span></a>, we can see that the first student starts by ‘Question/Happy’, then goes to ‘Argument/Anxious’ and so on.</p>
<div id="fig-multi2" class="quarto-figure quarto-figure-center anchored">
<figure class="figure">
<p><img src="multichannelcoded.png" class="img-fluid figure-img"></p>
<p></p><figcaption class="figure-caption"><strong>Figure</strong>&nbsp;2<strong>.</strong> An example of a multi-channel sequence object obtained by using the extended alphabet approach, i.e., combining the states of the utterances and facial expressions channels of the data shown in <a href="#fig-multi">Figure&nbsp;<span>13.1</span></a>.</figcaption><p></p>
</figure>
</div>
</section>
<section id="step-3-finding-patterns-clusters-or-trajectories" class="level3" data-number="2.3">
<h3 data-number="2.3" class="anchored" data-anchor-id="step-3-finding-patterns-clusters-or-trajectories"><span class="header-section-number">2.3</span> Step 3: Finding patterns (clusters or trajectories)</h3>
<p>Patterns may exist in all types of sequences and, in fact, in all types of data. Discovering such patterns, variations, or groups of patterns is a central theme in analytics. In sequence analysis, similar patterns reflect common temporal pathways where the data share a similar temporal course. This could be a group of students, a typical succession of behavior, or a sequence of interactions. As such, the last typical step in the analysis is to find such patterns. Since these patterns are otherwise latent or unobservable, we need a clustering algorithm that unveils such hidden patterns. There are different possibilities to cluster multi-channel sequence data, of which two are described below: extensions to traditional distance-based clustering approaches widely used in single-channel analyses and Markovian models. The two approaches are then further distinguished in Section <span class="math inline">\(\ref{covariates}\)</span>, with regard to the ability of the Markovian approach to directly accommodate covariates.</p>
<section id="traditional-sequence-analysis-extensions" class="level4" data-number="2.3.1">
<h4 data-number="2.3.1" class="anchored" data-anchor-id="traditional-sequence-analysis-extensions"><span class="header-section-number">2.3.1</span> Traditional sequence analysis extensions</h4>
<p>Broadly speaking, the first paradigm involves extending techniques commonly adopted in single-channel analyses to the multi-channel domain, by suitably summarising the information arising from all constituent channels. Within this first framework, two different approaches have been proposed.</p>
<p>The first consists of flattening the multi-channel data by combining the states (such as in the example in <a href="#fig-multi2">Figure&nbsp;<span>13.2</span></a>) and treating the sequence as a single channel with an extended alphabet. Typically, one would then compute dissimilarities using this extended alphabet, most commonly using Optimal Matching (OM). However, this approach is not limited to distance-based clustering; any of the methods, distance-based or otherwise, that we have seen in the previous chapters related to sequence analysis can be used to cluster sequences represented in this way (e.g., aggregated hierarchical clustering using OM, or hidden Markov models). While this seems like an easier choice, the models tend to become too complex —in the sense of requiring a larger number of clusters and/or hidden states in order to adequately characterise the data— when the number of channels or numbers of per-channel states increase. Moreover, for even a moderate number of channels and/or moderate numbers of states per-channel, the size of the combined alphabet can become unwieldy. Indeed, using this approach in conjunction with OM has been criticised because of the difficulty of specifying appropriate substitution costs for such large combined alphabets <span class="citation" data-cites="Ritschard2023">[<a href="../ch01-intro/intro.html#ref-Ritschard2023" role="doc-biblioref">12</a>]</span>. As a reminder, the substitution cost refers to the penalty associated with replacing one element of a sequence with another one, which is used to calculate the distance between sequences (a common preliminary step in clustering) (see Chapter 10 <span class="citation" data-cites="Saqr2024-tv">[<a href="../ch01-intro/intro.html#ref-Saqr2024-tv" role="doc-biblioref">3</a>]</span>).</p>
<p>The second, more common approach is explicitly distance-based and relies on an extension of the OM metric itself, by using a set of overall multi-channel costs derived from channel-specific costs, to calculate a pairwise dissimilarity matrix. The method relies on computing substitution costs for each constituent channel, combining the channels into a new multi-channel sequence object, and deriving an overall substitution cost matrix for the multi-channel object by adding (or averaging) the appropriate substitution costs across channels for a particular multi-state change, typically with equal weight given to each channel <span class="citation" data-cites="pollock2007">[<a href="../ch01-intro/intro.html#ref-pollock2007" role="doc-biblioref">13</a>]</span>. For instance, if the cost associated with substituting the states ‘Question’ and ‘Agreement’ in the utterances channel in <a href="#fig-multi">Figure&nbsp;<span>13.1</span></a> is <span class="math inline">\(0.6\)</span> and the cost of substituting ‘Happy’ and ‘Neutral’ in the facial expressions channel is <span class="math inline">\(1.2\)</span>, the cost associated with substitutions of ‘Question/Neutral’ for ‘Question/Happy’ and ‘Question/Neutral’ for ‘Agreement/Happy’ in <a href="#fig-multi2">Figure&nbsp;<span>13.2</span></a> would be <span class="math inline">\(1.2\)</span> and <span class="math inline">\(1.8\)</span>, respectively. From such multi-channel costs, a pairwise multi-channel dissimilarity matrix can be obtained and all subsequent steps of the clustering analysis can proceed as per Chapter 10 thereafter.</p>
<p>That being said, adopting the extended OM approach rather than the extended alphabet approach does not resolve all limitations of the distance-based clustering paradigm. As Saqr et al. <span class="citation" data-cites="IHE">[<a href="../ch01-intro/intro.html#ref-IHE" role="doc-biblioref">14</a>]</span> noted, large sequences are hard to cluster using standard methods such as hierarchical clustering, which is memory inefficient and hard to parallelise or scale <span class="citation" data-cites="BOUGUETTAYA20152785 Gilpin13">[<a href="../ch01-intro/intro.html#ref-BOUGUETTAYA20152785" role="doc-biblioref">15</a>, <a href="../ch01-intro/intro.html#ref-Gilpin13" role="doc-biblioref">16</a>]</span>. Furthermore, distance-based clustering methods are limited by the theoretical maximum dimension of a matrix in R which is 2,147,483,647, <!-- Added/edited the rest of the paragraph (S): --> corresponding to a maximum of 46,430 sequences. Using weights can fix the memory issue if the number of unique sequences remains below the threshold <span class="citation" data-cites="studer2013">[<a href="../ch01-intro/intro.html#ref-studer2013" role="doc-biblioref">17</a>]</span>. However, the more states (and combinations of states), the more unique the sequences tend to be, so the memory issue is even more typical with multi-channel sequence data. In such a case, Markovian methods may be the solution. Moreover, the particular choice of distance-based clustering algorithm must be chosen with care, and as ever the user must pre-specify the number of clusters, thereby often necessitating the evaluation of several computing solutions with different numbers of clusters, different hierarchical clustering linkage criteria, or different distance-based clustering algorithms entirely.</p>
</section>
<section id="mixture-hidden-markov-models" class="level4" data-number="2.3.2">
<h4 data-number="2.3.2" class="anchored" data-anchor-id="mixture-hidden-markov-models"><span class="header-section-number">2.3.2</span> Mixture hidden Markov models</h4>
<p>Even so, the extended OM approach is still liable to overestimate the number of clusters. A second, more sophisticated option is to use mixture hidden Markov models (MHMM) <span class="citation" data-cites="Helske2019">[<a href="../ch01-intro/intro.html#ref-Helske2019" role="doc-biblioref">18</a>]</span>, which we have already encountered in some detail in Chapter 12. Such models notably support both single- and multi-channel sequences and often lead to more parsimonious representations of the latent group structure than the distance-based paradigm. MHMMs are a thus a far more efficient and powerful method for temporally aligning the multiple channels of data into homogeneous temporal patterns. As we have learned in Chapter 12, when we estimate a mixture hidden Markov model, we need to specify the number of clusters (<span class="math inline">\(K\)</span>) and we create <span class="math inline">\(K\)</span> submodels that are each a hidden Markov model. Each submodel can have a different number of hidden states, which allows for great flexibility in modeling the variability of the data, without unduly inflating the number of clusters as per the distance-based approaches, thereby enabling more concise and interpretable characterisation of the distinct patterns in the data. Accommodating multi-channel sequences in the MHMM framework requires treating the observed states in each channel independently given the current hidden state. This can be easily performed by defining multiple emission probability matrices (one per channel). The assumption of conditional independence simplifies the model, but is sometimes unrealistic —if there are strong dependencies or interactions between the different channels—, in which case it is better to either analyse single-channel sequences (using extended alphabet) or resort to the distance-based paradigm described above.</p>
<p>We also learned in Chapter 12 that an advantage of MHMMs, as a probabilistic modelling approach, is that we can use traditional model selection methods such as likelihood-based information criteria or cross-validation for choosing the best model. For example, if the number of subpopulations is not known in advance —as is typically the case— we can compare models with different clustering solutions (be they those obtained with different numbers of clusters or different sets of initial probabilities, for example) and choose the best-fitting model with, for example, the Bayesian information criterion (BIC) <span class="citation" data-cites="schwarz1978">[<a href="../ch01-intro/intro.html#ref-schwarz1978" role="doc-biblioref">19</a>]</span>. Conversely, the distance-based paradigm relies on heuristic cluster quality measures for conducting model selection. In addition, an advantage of the distance-based approach is that it does not rely on making any assumptions about the data-generating mechanism. In other words, it does not assume that the data follows a probabilistic model.</p>
<p>The extended OM method for calculating multi-channel dissimilarities is implemented in the R package <code>TraMineR</code> and is applied in our case study, while the extended alphabet approach (i.e., combining all channels into a single one where the alphabet contains all possible state combinations) is not pursued any further here. We also cluster via the MHMM framework in our case study, using the R package <code>seqHMM</code> <span class="citation" data-cites="seqHMM">[<a href="../ch01-intro/intro.html#ref-seqHMM" role="doc-biblioref">20</a>]</span>, in order to empirically compare and contrast both perspectives. It is worth noting that, of the Markovian methods we learned about in Chapter 12, only hidden Markov models and mixture hidden Markov models explicitly allow for multi-channel sequences by treating the observed states in each channel independently given the current hidden state. The more basic Markov and mixture Markov models can only accommodate multi-channel sequences by treating them as a single channel using the extended alphabet approach described above, but we do not consider this option any further here. To summarise, we do not explore the extended alphabet approach in either the distance-based or Markovian settings; we only demonstrate the multi-channel extension of the OM metric from the distance-based point of view, and only the MHMM approach from the Markovian point of view.</p>
</section>
</section>
<section id="covariates" class="level3" data-number="2.4">
<h3 data-number="2.4" class="anchored" data-anchor-id="covariates"><span class="header-section-number">2.4</span> Step 4: Relating clusters to covariates</h3>
<p>As we have seen, there are, broadly speaking, two conflicting perspectives on clustering in the sequence analysis community; algorithmic, distance-based clustering on the one hand, and model-based clustering on the other. Distance-based clustering of multi-channel sequences has already been described above, but it is useful to acknowledge that mixture Markov models and mixture hidden Markov models are precisely examples of model-based clustering methods. Moreover, <code>seqHMM</code> and the methods it implements are unique in offering a model-based approach to clustering multi-channel sequences. A key advantage of the model-based clustering framework is that it can easily be extended to directly account for information available in the form of covariates, as part of the underlying probabilistic model. Though the recently introduced mixture of exponential-distance models framework <span class="citation" data-cites="MEDseq">[<a href="../ch01-intro/intro.html#ref-MEDseq" role="doc-biblioref">21</a>]</span> attempts to reconcile the distance-based and model-based cultures in sequence analysis, while allowing for the direct incorporation of covariates, it is not based on Markovian principles, and most importantly can currently only accommodate single-channel sequences. Otherwise, distance-based approaches typically cannot accommodate covariates, except as part of a post-hoc step whereby, typically, covariates are used as explanatory variables in a post-hoc multinomial regression with the cluster memberships used as the response (or as independent variables in linear or non-linear regression models). This is questionable as substituting a categorical variable indicating cluster membership disregards the heterogeneity within clusters and is clearly only sensible when the clusters are sufficiently homogeneous <span class="citation" data-cites="Studer2018-aw Helske2023-yj">[<a href="../ch01-intro/intro.html#ref-Studer2018-aw" role="doc-biblioref">22</a>, <a href="../ch01-intro/intro.html#ref-Helske2023-yj" role="doc-biblioref">23</a>]</span>. It is often more desirable to incorporate covariates directly, i.e.&nbsp;to cluster sequences and relate the clusters to the covariates simultaneously. This represents an important distinction between the two approaches outlined above; this step does not apply to distance-based clustering approaches and is a crucial advantage of the Markovian approach which makes MHMMs even more powerful tools for clustering multi-channel sequences.</p>
<p>In theory, MHMMs can include covariates to explain the initial, transition, and/or emission probabilities. A natural use-case would be to allow subject-specific and possibly time-varying transition and emission probabilities (in the case of time-varying covariates). For example, if we think that transitioning from low to high achievement gets harder as the students get older we may add time as an explanatory variable to the model, allowing the probability of transitioning from low to high achievement to diminish in time. However, at the time of writing this chapter, these extensions are not supported in <code>seqHMM</code> (this may change in the future). Instead, the <code>seqHMM</code> package used in the examples supports time-constant covariates only. Specifically, the manner in which covariates are accommodated is similar in spirit to the aforementioned mixture of exponential-distance models framework and latent class regression <span class="citation" data-cites="Dayton1988">[<a href="../ch01-intro/intro.html#ref-Dayton1988" role="doc-biblioref">24</a>]</span>, in that covariates are used for predicting cluster memberships for each observed sequence. Adding covariates to the model thus helps to both explain and influence the probabilities that each individual has of belonging to each cluster. By incorporating covariates in this way, we could, for example, find that being in a high-achievement cluster is predicted by gender, previous grades, or family background</p>
<p>In the terminology of mixtures of experts modelling, this approach corresponds to a so-called “gating network mixture of experts model”, whereby the distribution of the sequences depends on the latent cluster membership variable, which in turn depends on the covariates, while the sequences are independent of the covariates, conditional on the latent cluster membership variable <span class="citation" data-cites="MoEClust">[<a href="../ch01-intro/intro.html#ref-MoEClust" role="doc-biblioref">25</a>]</span>. This, rather than having covariates affect the component distributions, is particularly appealing, as the interpretation of state-specific parameters is the same as it would be under a model without covariates. However, it is worth noting that the covariates do not merely explain the uncovered clusters; as part of the model, they drive the formation of the clusters. In other words, an otherwise identical model without dependence on covariates may uncover different groupings with different probabilities. However, this can be easily overcome by treating the selection of the most relevant subset of covariates as an issue of model selection via the BIC or other criteria and taking the number of clusters/states, set of initial probabilities, and set of covariates which jointly optimise the chosen criterion. The incorporation of covariates in MHMMs and related practical issues are also illustrated in the case study on the longitudinal association of engagement and achievement which follows.</p>
</section>
</section>
<section id="review-of-the-literature" class="level2" data-number="3">
<h2 data-number="3" class="anchored" data-anchor-id="review-of-the-literature"><span class="header-section-number">3</span> Review of the literature</h2>
<p>The use of multi-channel sequence analysis in learning analytics has so far been scarce. Most of the few studies that implemented this method used it to combine multiple modalities of data such as coded video data <span class="citation" data-cites="Trmnen2022a Trmnen2022b">[<a href="../ch01-intro/intro.html#ref-Trmnen2022a" role="doc-biblioref">26</a>, <a href="../ch01-intro/intro.html#ref-Trmnen2022b" role="doc-biblioref">27</a>]</span>, electrodermal activity <span class="citation" data-cites="Trmnen2022a Trmnen2022b">[<a href="../ch01-intro/intro.html#ref-Trmnen2022a" role="doc-biblioref">26</a>, <a href="../ch01-intro/intro.html#ref-Trmnen2022b" role="doc-biblioref">27</a>]</span>, clickstream/logged data <span class="citation" data-cites="Ouyang2023 LopezPernas2021 Saqr2023">[<a href="../ch01-intro/intro.html#ref-Saqr2023" role="doc-biblioref">10</a>, <a href="../ch01-intro/intro.html#ref-Ouyang2023" role="doc-biblioref">28</a>, <a href="../ch01-intro/intro.html#ref-LopezPernas2021" role="doc-biblioref">29</a>]</span>, and assessment/achievement data <span class="citation" data-cites="LopezPernas2021 Saqr2023 Bacci2022">[<a href="../ch01-intro/intro.html#ref-Saqr2023" role="doc-biblioref">10</a>, <a href="../ch01-intro/intro.html#ref-LopezPernas2021" role="doc-biblioref">29</a>, <a href="../ch01-intro/intro.html#ref-Bacci2022" role="doc-biblioref">30</a>]</span>. The data were converted into different sequence channels using a variety of methods. For example, <span class="citation" data-cites="Trmnen2022a">[<a href="../ch01-intro/intro.html#ref-Trmnen2022a" role="doc-biblioref">26</a>]</span> manually coded video interactions as positive/negative/mixed to represent the emotional valence of individual interaction, and used a pre-defined threshold to discern between high and low arousal from electrodermal activity data. In the work by <span class="citation" data-cites="LopezPernas2021">[<a href="../ch01-intro/intro.html#ref-LopezPernas2021" role="doc-biblioref">29</a>]</span>, two sequence channels were built from students’ daily tactics using the learning management system and an automated assessment tool for programming assignments respectively. The learning tactics were identified through hierarchical clustering of students’ trace log data in each environment. Similarly <span class="citation" data-cites="Saqr2023">[<a href="../ch01-intro/intro.html#ref-Saqr2023" role="doc-biblioref">10</a>]</span>, created an engagement channel for each course in a study program based on students’ engagement states derived from the learning management system data, and an achievement state based on their grade tertiles. Another study <span class="citation" data-cites="Ouyang2023">[<a href="../ch01-intro/intro.html#ref-Ouyang2023" role="doc-biblioref">28</a>]</span> had five separate channels: the first channel represented the interactive dimension built from the social interactions through peer communications and online behaviours; the second channel represented the cognitive dimension constructed from students’ knowledge contributions at the superficial, medium, and deep levels; the third channel represented the regulative dimension which represented students’ regulation of their collaborative processes, including task understanding, goal setting and planning, as well as monitoring and reflection; the fourth channel represented the behavioural dimension which analysed students’ online behaviours, including resource management, concept mapping and observation, and the fifth channel represented the socio-emotional dimension, which included active listening and respect, encouraging participation and inclusion, as well as fostering cohesion.</p>
<p>A common step in the existing works is the use of clustering techniques to detect unobserved patterns within the multi-channel sequences. Articles have relied on hidden Markov models to identify hidden states in the data. For instance, <span class="citation" data-cites="LopezPernas2021">[<a href="../ch01-intro/intro.html#ref-LopezPernas2021" role="doc-biblioref">29</a>]</span> found three hidden states consisting of learning strategies which combine the use of the learning management system and an automated assessment tool: an instruction-oriented strategy where students consume learning resources to learn how to code; an independent coding strategy where students relied on their knowledge or used the learning resources available to complete the assignments, and a dependent coding strategy where students mostly relied on the help forums to complete their programming assignments. Most studies go one step further and identify distinct trajectories based on such hidden states. For example, <span class="citation" data-cites="Trmnen2022b">[<a href="../ch01-intro/intro.html#ref-Trmnen2022b" role="doc-biblioref">27</a>]</span> found four clusters of socio-emotional interaction episodes (positive, negative, occasional regulation, frequent regulation), which differed in terms of fluctuation of affective states and activated regulation of learning. The authors of <span class="citation" data-cites="Ouyang2023">[<a href="../ch01-intro/intro.html#ref-Ouyang2023" role="doc-biblioref">28</a>]</span> found three types of group collaborative patterns: behaviour-oriented, communication-behaviour-synergistic, and communication-oriented. To the knowledge of the authors, no article has relied on the distance-based approach (commonly used in single-channel sequence analysis) to cluster multi-channel sequences. However, this approach has been used in social sciences <span class="citation" data-cites="Gauthier2010">[<a href="../ch01-intro/intro.html#ref-Gauthier2010" role="doc-biblioref">9</a>]</span> as well as in other disciplines <span class="citation" data-cites="Liu2021">[e.g., <a href="../ch01-intro/intro.html#ref-Liu2021" role="doc-biblioref">31</a>]</span>.</p>
</section>
<section id="case-study-the-longitudinal-association-of-engagement-and-achievement" class="level2" data-number="4">
<h2 data-number="4" class="anchored" data-anchor-id="case-study-the-longitudinal-association-of-engagement-and-achievement"><span class="header-section-number">4</span> Case study: the longitudinal association of engagement and achievement</h2>
<p>To learn how to implement multi-channel sequence analysis we are going to practice with a real case study: we will investigate the longitudinal association between engagement and achievement across a study program using simulated data based on the study by <span class="citation" data-cites="Saqr2023">[<a href="../ch01-intro/intro.html#ref-Saqr2023" role="doc-biblioref">10</a>]</span>. We begin by creating a sequence for each of the channels (engagement and achievement) and then explore visualisations thereof. We then focus on clustering these data using the methods described above specifically tailored for multi-channel sequences, in order to present an empirical view of both the distance-based and Markovian perspectives. In doing so, we will first demonstrate how to construct a multi-channel pairwise OM dissimilarity matrix in order to apply the distance-based clustering approach of Chapter 10 to these data. Secondly, we will largely focus on using a mixture hidden Markov model to detect the longitudinal clusters of students that share a similar trajectory of engagement and achievement. Finally, we will demonstrate how to incorporate covariates under the model-based Markovian framework.</p>
<!-- We note that the same data were analysed in Chapter 12, from a Markovian perspective only, albeit mainly from the point of view of single-channel analysis using the engagement sequences. Though some results were presented pertaining to a simultaneous analysis of the engagement and achievement sequences in Chapter 12, we present the multi-channel perspective in greater detail here. -->
<!-- It is not engagement anymore (SLP)  -->
<section id="the-packages" class="level3" data-number="4.1">
<h3 data-number="4.1" class="anchored" data-anchor-id="the-packages"><span class="header-section-number">4.1</span> The packages</h3>
<p>To accomplish our task, we will rely on several R packages We have use most of them throughout the book. Below is a brief summary of the packages required:</p>
<ul>
<li><code>rio</code>: A package for reading and saving data files with different extensions <span class="citation" data-cites="rio">[<a href="../ch01-intro/intro.html#ref-rio" role="doc-biblioref">32</a>]</span>.</li>
<li><code>seqHMM</code>: A package designed for fitting hidden (latent) Markov models and mixture hidden Markov models for social sequence data and other categorical time series <span class="citation" data-cites="seqHMM">[<a href="../ch01-intro/intro.html#ref-seqHMM" role="doc-biblioref">20</a>]</span>.</li>
<li><code>tidyverse</code>: A package that encompasses several basic packages for data manipulation and wrangling <span class="citation" data-cites="tidyverse">[<a href="../ch01-intro/intro.html#ref-tidyverse" role="doc-biblioref">33</a>]</span>.</li>
<li><code>TraMineR</code>: As seen in the introductory sequence analysis chapter, this package helps us construct, analyse, and visualise sequences from time-ordered states or events <span class="citation" data-cites="Gabadinho2011">[<a href="../ch01-intro/intro.html#ref-Gabadinho2011" role="doc-biblioref">34</a>]</span>.</li>
<li><code>WeightedCluster</code>: A package to cluster sequences and computing quality measures <span class="citation" data-cites="studer2013">[<a href="../ch01-intro/intro.html#ref-studer2013" role="doc-biblioref">17</a>]</span>.</li>
</ul>
<p>If you have not done so already, install the packages using the <code>install.packages()</code> command (e.g., <code>install.packages("seqHMM")</code>). We can then import them as follows:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(rio)</span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tidyverse)</span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(TraMineR)</span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(seqHMM) </span>
<span id="cb1-5"><a href="#cb1-5" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(WeightedCluster) </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="the-data" class="level3" data-number="4.2">
<h3 data-number="4.2" class="anchored" data-anchor-id="the-data"><span class="header-section-number">4.2</span> The data</h3>
<p>The data that we are going to use in this chapter is a synthetic dataset which contains the engagement states (<code>Active</code>, <code>Average</code>, or <code>Disengaged</code>) and achievement states (<code>Achiever</code>, <code>Intermediate</code>, or <code>Low</code>) for eight successive courses (each course is a timepoint). Each row contains an identifier for the student (<code>UserID</code>), an identifier for the course (<code>CourseId</code>), and the order (<code>Sequence</code>) in which the student took that course (1–8). For each course, a student has both an engagement state (<code>Engagement</code>) and an achievement state (<code>Achievement</code>). For example, a student can be <code>'Active'</code> and <code>'Achiever'</code> in the first course (<code>Sequence</code> = 1) they take, and <code>'Disengaged'</code> and <code>'Low'</code> achiever in the next. In addition, the dataset contains the final grade (0-100) and three time-constant covariates (they are the same for each student throughout all four courses): the previous grade (<code>Prev_grade</code>, 1-10), <code>Attitude</code> (0-20), and <code>Gender</code> (Male/Female). The dataset is described in more detail in the Data chapter of this book. We can import the data using the <code>ìmport()</code> command from <code>rio</code>. A preview is shown in <a href="#tbl-df">Table&nbsp;<span>13.1</span></a>.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb2"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a>URL <span class="ot">&lt;-</span> <span class="st">"https://github.com/sonsoleslp/labook-data/raw/main/"</span></span>
<span id="cb2-2"><a href="#cb2-2" aria-hidden="true" tabindex="-1"></a>fileName <span class="ot">&lt;-</span> <span class="st">"9_longitudinalEngagement/SequenceEngagementAchievement.xlsx"</span></span>
<span id="cb2-3"><a href="#cb2-3" aria-hidden="true" tabindex="-1"></a>df <span class="ot">&lt;-</span> <span class="fu">import</span>(<span class="fu">paste0</span>(URL, fileName))</span>
<span id="cb2-4"><a href="#cb2-4" aria-hidden="true" tabindex="-1"></a>df</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="cell-output-display">
<div id="tbl-df" class="anchored">

<div id="xmxywpliwa" style="padding-left:0px;padding-right:0px;padding-top:10px;padding-bottom:10px;overflow-x:auto;overflow-y:auto;width:auto;height:auto;">
<style>#xmxywpliwa table {
  font-family: system-ui, 'Segoe UI', Roboto, Helvetica, Arial, sans-serif, 'Apple Color Emoji', 'Segoe UI Emoji', 'Segoe UI Symbol', 'Noto Color Emoji';
  -webkit-font-smoothing: antialiased;
  -moz-osx-font-smoothing: grayscale;
}

#xmxywpliwa thead, #xmxywpliwa tbody, #xmxywpliwa tfoot, #xmxywpliwa tr, #xmxywpliwa td, #xmxywpliwa th {
  border-style: none;
}

#xmxywpliwa p {
  margin: 0;
  padding: 0;
}

#xmxywpliwa .gt_table {
  display: table;
  border-collapse: collapse;
  line-height: normal;
  margin-left: auto;
  margin-right: auto;
  color: #333333;
  font-size: 16px;
  font-weight: normal;
  font-style: normal;
  background-color: #FFFFFF;
  width: auto;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #A8A8A8;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #A8A8A8;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
}

#xmxywpliwa .gt_caption {
  padding-top: 4px;
  padding-bottom: 4px;
}

#xmxywpliwa .gt_title {
  color: #333333;
  font-size: 125%;
  font-weight: initial;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-color: #FFFFFF;
  border-bottom-width: 0;
}

#xmxywpliwa .gt_subtitle {
  color: #333333;
  font-size: 85%;
  font-weight: initial;
  padding-top: 3px;
  padding-bottom: 5px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-color: #FFFFFF;
  border-top-width: 0;
}

#xmxywpliwa .gt_heading {
  background-color: #FFFFFF;
  text-align: center;
  border-bottom-color: #FFFFFF;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#xmxywpliwa .gt_bottom_border {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#xmxywpliwa .gt_col_headings {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#xmxywpliwa .gt_col_heading {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: normal;
  text-transform: inherit;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 6px;
  padding-left: 5px;
  padding-right: 5px;
  overflow-x: hidden;
}

#xmxywpliwa .gt_column_spanner_outer {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: normal;
  text-transform: inherit;
  padding-top: 0;
  padding-bottom: 0;
  padding-left: 4px;
  padding-right: 4px;
}

#xmxywpliwa .gt_column_spanner_outer:first-child {
  padding-left: 0;
}

#xmxywpliwa .gt_column_spanner_outer:last-child {
  padding-right: 0;
}

#xmxywpliwa .gt_column_spanner {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 5px;
  overflow-x: hidden;
  display: inline-block;
  width: 100%;
}

#xmxywpliwa .gt_spanner_row {
  border-bottom-style: hidden;
}

#xmxywpliwa .gt_group_heading {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  text-align: left;
}

#xmxywpliwa .gt_empty_group_heading {
  padding: 0.5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: middle;
}

#xmxywpliwa .gt_from_md > :first-child {
  margin-top: 0;
}

#xmxywpliwa .gt_from_md > :last-child {
  margin-bottom: 0;
}

#xmxywpliwa .gt_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  margin: 10px;
  border-top-style: solid;
  border-top-width: 1px;
  border-top-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  overflow-x: hidden;
}

#xmxywpliwa .gt_stub {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
}

#xmxywpliwa .gt_stub_row_group {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
  vertical-align: top;
}

#xmxywpliwa .gt_row_group_first td {
  border-top-width: 2px;
}

#xmxywpliwa .gt_row_group_first th {
  border-top-width: 2px;
}

#xmxywpliwa .gt_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#xmxywpliwa .gt_first_summary_row {
  border-top-style: solid;
  border-top-color: #D3D3D3;
}

#xmxywpliwa .gt_first_summary_row.thick {
  border-top-width: 2px;
}

#xmxywpliwa .gt_last_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#xmxywpliwa .gt_grand_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#xmxywpliwa .gt_first_grand_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-style: double;
  border-top-width: 6px;
  border-top-color: #D3D3D3;
}

#xmxywpliwa .gt_last_grand_summary_row_top {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: double;
  border-bottom-width: 6px;
  border-bottom-color: #D3D3D3;
}

#xmxywpliwa .gt_striped {
  background-color: rgba(128, 128, 128, 0.05);
}

#xmxywpliwa .gt_table_body {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#xmxywpliwa .gt_footnotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#xmxywpliwa .gt_footnote {
  margin: 0px;
  font-size: 90%;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#xmxywpliwa .gt_sourcenotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#xmxywpliwa .gt_sourcenote {
  font-size: 90%;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#xmxywpliwa .gt_left {
  text-align: left;
}

#xmxywpliwa .gt_center {
  text-align: center;
}

#xmxywpliwa .gt_right {
  text-align: right;
  font-variant-numeric: tabular-nums;
}

#xmxywpliwa .gt_font_normal {
  font-weight: normal;
}

#xmxywpliwa .gt_font_bold {
  font-weight: bold;
}

#xmxywpliwa .gt_font_italic {
  font-style: italic;
}

#xmxywpliwa .gt_super {
  font-size: 65%;
}

#xmxywpliwa .gt_footnote_marks {
  font-size: 75%;
  vertical-align: 0.4em;
  position: initial;
}

#xmxywpliwa .gt_asterisk {
  font-size: 100%;
  vertical-align: 0;
}

#xmxywpliwa .gt_indent_1 {
  text-indent: 5px;
}

#xmxywpliwa .gt_indent_2 {
  text-indent: 10px;
}

#xmxywpliwa .gt_indent_3 {
  text-indent: 15px;
}

#xmxywpliwa .gt_indent_4 {
  text-indent: 20px;
}

#xmxywpliwa .gt_indent_5 {
  text-indent: 25px;
}
</style>
<table class="gt_table" data-quarto-disable-processing="false" data-quarto-bootstrap="false"><caption>Table&nbsp;1.  Preview of the data </caption>
  <thead>
    
    <tr class="gt_col_headings">
      <th class="gt_col_heading gt_columns_bottom_border gt_left" rowspan="1" colspan="1" scope="col" id=""></th>
      <th class="gt_col_heading gt_columns_bottom_border gt_left" rowspan="1" colspan="1" scope="col" id="UserID">UserID</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_left" rowspan="1" colspan="1" scope="col" id="CourseID">CourseID</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1" scope="col" id="Sequence">Sequence</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_left" rowspan="1" colspan="1" scope="col" id="Engagement">Engagement</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1" scope="col" id="Final_Grade">Final_Grade</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_left" rowspan="1" colspan="1" scope="col" id="Achievement">Achievement</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1" scope="col" id="Prev_grade">Prev_grade</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1" scope="col" id="Attitude">Attitude</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_left" rowspan="1" colspan="1" scope="col" id="Gender">Gender</th>
    </tr>
  </thead>
  <tbody class="gt_table_body">
    <tr><th id="stub_1_1" scope="row" class="gt_row gt_right gt_stub" style="font-family: Courier;">1</th>
<td headers="stub_1_1 UserID" class="gt_row gt_left">00050F0E</td>
<td headers="stub_1_1 CourseID" class="gt_row gt_left">4C3F37F0</td>
<td headers="stub_1_1 Sequence" class="gt_row gt_right">1</td>
<td headers="stub_1_1 Engagement" class="gt_row gt_left">Average</td>
<td headers="stub_1_1 Final_Grade" class="gt_row gt_right">72.27</td>
<td headers="stub_1_1 Achievement" class="gt_row gt_left">Achiever</td>
<td headers="stub_1_1 Prev_grade" class="gt_row gt_right">6.826613</td>
<td headers="stub_1_1 Attitude" class="gt_row gt_right">12.92833</td>
<td headers="stub_1_1 Gender" class="gt_row gt_left">Male</td></tr>
    <tr><th id="stub_1_2" scope="row" class="gt_row gt_right gt_stub" style="font-family: Courier;">2</th>
<td headers="stub_1_2 UserID" class="gt_row gt_left">00050F0E</td>
<td headers="stub_1_2 CourseID" class="gt_row gt_left">E54A52A3</td>
<td headers="stub_1_2 Sequence" class="gt_row gt_right">2</td>
<td headers="stub_1_2 Engagement" class="gt_row gt_left">Disengaged</td>
<td headers="stub_1_2 Final_Grade" class="gt_row gt_right">72.56</td>
<td headers="stub_1_2 Achievement" class="gt_row gt_left">Achiever</td>
<td headers="stub_1_2 Prev_grade" class="gt_row gt_right">6.826613</td>
<td headers="stub_1_2 Attitude" class="gt_row gt_right">12.92833</td>
<td headers="stub_1_2 Gender" class="gt_row gt_left">Male</td></tr>
    <tr><th id="stub_1_3" scope="row" class="gt_row gt_right gt_stub" style="font-family: Courier;">3</th>
<td headers="stub_1_3 UserID" class="gt_row gt_left">00050F0E</td>
<td headers="stub_1_3 CourseID" class="gt_row gt_left">AB7EC624</td>
<td headers="stub_1_3 Sequence" class="gt_row gt_right">3</td>
<td headers="stub_1_3 Engagement" class="gt_row gt_left">Average</td>
<td headers="stub_1_3 Final_Grade" class="gt_row gt_right">78.78</td>
<td headers="stub_1_3 Achievement" class="gt_row gt_left">Achiever</td>
<td headers="stub_1_3 Prev_grade" class="gt_row gt_right">6.826613</td>
<td headers="stub_1_3 Attitude" class="gt_row gt_right">12.92833</td>
<td headers="stub_1_3 Gender" class="gt_row gt_left">Male</td></tr>
    <tr><th id="stub_1_4" scope="row" class="gt_row gt_right gt_stub" style="font-family: Courier;">4</th>
<td headers="stub_1_4 UserID" class="gt_row gt_left">00050F0E</td>
<td headers="stub_1_4 CourseID" class="gt_row gt_left">B0E95213</td>
<td headers="stub_1_4 Sequence" class="gt_row gt_right">4</td>
<td headers="stub_1_4 Engagement" class="gt_row gt_left">Average</td>
<td headers="stub_1_4 Final_Grade" class="gt_row gt_right">74.19</td>
<td headers="stub_1_4 Achievement" class="gt_row gt_left">Achiever</td>
<td headers="stub_1_4 Prev_grade" class="gt_row gt_right">6.826613</td>
<td headers="stub_1_4 Attitude" class="gt_row gt_right">12.92833</td>
<td headers="stub_1_4 Gender" class="gt_row gt_left">Male</td></tr>
    <tr><th id="stub_1_5" scope="row" class="gt_row gt_right gt_stub" style="font-family: Courier;">5</th>
<td headers="stub_1_5 UserID" class="gt_row gt_left">00050F0E</td>
<td headers="stub_1_5 CourseID" class="gt_row gt_left">0B301F55</td>
<td headers="stub_1_5 Sequence" class="gt_row gt_right">5</td>
<td headers="stub_1_5 Engagement" class="gt_row gt_left">Average</td>
<td headers="stub_1_5 Final_Grade" class="gt_row gt_right">87.35</td>
<td headers="stub_1_5 Achievement" class="gt_row gt_left">Achiever</td>
<td headers="stub_1_5 Prev_grade" class="gt_row gt_right">6.826613</td>
<td headers="stub_1_5 Attitude" class="gt_row gt_right">12.92833</td>
<td headers="stub_1_5 Gender" class="gt_row gt_left">Male</td></tr>
    <tr><th id="stub_1_6" scope="row" class="gt_row gt_right gt_stub" style="font-family: Courier; font-size: x-small; background-color: #E4E4E4;">6..1135</th>
<td headers="stub_1_6 UserID" class="gt_row gt_left" style="background-color: #E4E4E4;"></td>
<td headers="stub_1_6 CourseID" class="gt_row gt_left" style="background-color: #E4E4E4;"></td>
<td headers="stub_1_6 Sequence" class="gt_row gt_right" style="background-color: #E4E4E4;"></td>
<td headers="stub_1_6 Engagement" class="gt_row gt_left" style="background-color: #E4E4E4;"></td>
<td headers="stub_1_6 Final_Grade" class="gt_row gt_right" style="background-color: #E4E4E4;"></td>
<td headers="stub_1_6 Achievement" class="gt_row gt_left" style="background-color: #E4E4E4;"></td>
<td headers="stub_1_6 Prev_grade" class="gt_row gt_right" style="background-color: #E4E4E4;"></td>
<td headers="stub_1_6 Attitude" class="gt_row gt_right" style="background-color: #E4E4E4;"></td>
<td headers="stub_1_6 Gender" class="gt_row gt_left" style="background-color: #E4E4E4;"></td></tr>
    <tr><th id="stub_1_7" scope="row" class="gt_row gt_right gt_stub" style="font-family: Courier;">1136</th>
<td headers="stub_1_7 UserID" class="gt_row gt_left">FE2E4C85</td>
<td headers="stub_1_7 CourseID" class="gt_row gt_left">79ED6873</td>
<td headers="stub_1_7 Sequence" class="gt_row gt_right">8</td>
<td headers="stub_1_7 Engagement" class="gt_row gt_left">Active</td>
<td headers="stub_1_7 Final_Grade" class="gt_row gt_right">87.69</td>
<td headers="stub_1_7 Achievement" class="gt_row gt_left">Achiever</td>
<td headers="stub_1_7 Prev_grade" class="gt_row gt_right">4.189420</td>
<td headers="stub_1_7 Attitude" class="gt_row gt_right">20.00000</td>
<td headers="stub_1_7 Gender" class="gt_row gt_left">Male</td></tr>
  </tbody>
  
  
</table>
</div>
</div>
</div>
</div>
</section>
<section id="creating-the-sequences" class="level3" data-number="4.3">
<h3 data-number="4.3" class="anchored" data-anchor-id="creating-the-sequences"><span class="header-section-number">4.3</span> Creating the sequences</h3>
<p>We are going to first construct and visualise each channel separately (engagement and achievement), and then study them in combination.</p>
<section id="engagement-channel" class="level4" data-number="4.3.1">
<h4 data-number="4.3.1" class="anchored" data-anchor-id="engagement-channel"><span class="header-section-number">4.3.1</span> Engagement channel</h4>
<p>To build the engagement channel, we need to construct a sequence of students’ engagement states throughout the eight courses. To do so, we need to first arrange our data by student (<code>UserID</code>) and course order (<code>Sequence</code>). Then, we pivot the data to a wide format, where the first column is the <code>UserID</code> and the rest of the columns are the engagement states at each of the courses (ordered from 1 to 8). For more details about this process, refer to the introductory sequence analysis chapter.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb3"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a>eng_seq_df <span class="ot">&lt;-</span> df <span class="sc">|&gt;</span> <span class="fu">arrange</span>(UserID, Sequence) <span class="sc">|&gt;</span></span>
<span id="cb3-2"><a href="#cb3-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pivot_wider</span>(<span class="at">id_cols =</span> <span class="st">"UserID"</span>, <span class="at">names_from =</span> <span class="st">"Sequence"</span>, <span class="at">values_from =</span> <span class="st">"Engagement"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Now we can use <code>TraMineR</code> to construct the sequence object and assign colours to it to represent each of the engagement states:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb4"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a>engagement_levels <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"Active"</span>, <span class="st">"Average"</span>, <span class="st">"Disengaged"</span>)</span>
<span id="cb4-2"><a href="#cb4-2" aria-hidden="true" tabindex="-1"></a>colours <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"#28a41f"</span>, <span class="st">"#FFDF3C"</span>, <span class="st">"#e01a4f"</span>)</span>
<span id="cb4-3"><a href="#cb4-3" aria-hidden="true" tabindex="-1"></a>eng_seq <span class="ot">&lt;-</span> <span class="fu">seqdef</span>(eng_seq_df , <span class="dv">2</span><span class="sc">:</span><span class="dv">9</span>, <span class="at">alphabet =</span> engagement_levels, <span class="at">cpal =</span> colours)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>We can use the sequence distribution plot from <code>TraMineR</code> to visualise the distribution of each state at each time point, and the sequence index plot to visualise each student’s sequence of engagement states in <a href="#fig-seqeng">Figure&nbsp;<span>13.3</span></a>:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb5"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a><span class="fu">seqdplot</span>(eng_seq, <span class="at">border =</span> <span class="cn">NA</span>,  <span class="at">ncol =</span> <span class="dv">3</span>, <span class="at">legend.prop =</span> <span class="fl">0.2</span>)</span>
<span id="cb5-2"><a href="#cb5-2" aria-hidden="true" tabindex="-1"></a><span class="fu">seqIplot</span>(eng_seq, <span class="at">border =</span> <span class="cn">NA</span>,  <span class="at">ncol =</span> <span class="dv">3</span>, <span class="at">legend.prop =</span> <span class="fl">0.2</span>, <span class="at">sortv =</span> <span class="st">"from.start"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell" data-layout-align="center">
<div class="cell-output-display">
<div id="fig-seqeng" class="quarto-figure quarto-figure-center anchored">
<figure class="figure">
<p><img src="ch13-multi_files/figure-html/fig-seqeng-1.png" class="img-fluid figure-img" width="3750"></p>
<p></p><figcaption class="figure-caption"><strong>Figure</strong>&nbsp;3<strong>.</strong> Sequence distribution plot and index plot of the course engagement states.</figcaption><p></p>
</figure>
</div>
</div>
</div>
<p>Please, refer to Chapter 10 <span class="citation" data-cites="Saqr2024-tv">[<a href="../ch01-intro/intro.html#ref-Saqr2024-tv" role="doc-biblioref">3</a>]</span> for guidance on how to interpret sequence distribution and index plots.</p>
</section>
<section id="achievement-channel" class="level4" data-number="4.3.2">
<h4 data-number="4.3.2" class="anchored" data-anchor-id="achievement-channel"><span class="header-section-number">4.3.2</span> Achievement channel</h4>
<p>We follow a similar process to construct the achievement sequences. First we arrange the data by student and course order and then we convert the data into the wider format using —this time— the achievement states as the values.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb6"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a>ach_seq_df <span class="ot">&lt;-</span> df <span class="sc">|&gt;</span> <span class="fu">arrange</span>(UserID,Sequence) <span class="sc">|&gt;</span></span>
<span id="cb6-2"><a href="#cb6-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pivot_wider</span>(<span class="at">id_cols =</span> <span class="st">"UserID"</span>, <span class="at">names_from =</span> <span class="st">"Sequence"</span>, <span class="at">values_from =</span> <span class="st">"Achievement"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>We use again <code>TraMineR</code> to construct the sequence object for achievement and we again provide a suitable, distinct colour scheme:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb7"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a>achievement_levels <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"Low"</span>, <span class="st">"Intermediate"</span>, <span class="st">"Achiever"</span>)</span>
<span id="cb7-2"><a href="#cb7-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-3"><a href="#cb7-3" aria-hidden="true" tabindex="-1"></a>coloursA <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"#a5e3ff"</span>,<span class="st">"#309bff"</span>,<span class="st">"#3659bf"</span>)</span>
<span id="cb7-4"><a href="#cb7-4" aria-hidden="true" tabindex="-1"></a>ach_seq <span class="ot">&lt;-</span> <span class="fu">seqdef</span>(ach_seq_df , <span class="dv">2</span><span class="sc">:</span><span class="dv">9</span>, <span class="at">cpal =</span> coloursA, <span class="at">alphabet =</span> achievement_levels)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>We may use the same visualisations to plot our achievement sequences in <a href="#fig-seqach">Figure&nbsp;<span>13.4</span></a>:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb8"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a><span class="fu">seqdplot</span>(ach_seq, <span class="at">border =</span> <span class="cn">NA</span>,  <span class="at">ncol =</span> <span class="dv">3</span>, <span class="at">legend.prop =</span> <span class="fl">0.2</span>)</span>
<span id="cb8-2"><a href="#cb8-2" aria-hidden="true" tabindex="-1"></a><span class="fu">seqIplot</span>(ach_seq, <span class="at">border =</span> <span class="cn">NA</span>,  <span class="at">ncol =</span> <span class="dv">3</span>, <span class="at">legend.prop =</span> <span class="fl">0.2</span>, <span class="at">sortv =</span> <span class="st">"from.start"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell" data-layout-align="center">
<div class="cell-output-display">
<div id="fig-seqach" class="quarto-figure quarto-figure-center anchored">
<figure class="figure">
<p><img src="ch13-multi_files/figure-html/fig-seqach-1.png" class="img-fluid figure-img" width="3750"></p>
<p></p><figcaption class="figure-caption"><strong>Figure</strong>&nbsp;4<strong>.</strong> Sequence distribution plot and index plot of the course achievement states.</figcaption><p></p>
</figure>
</div>
</div>
</div>
</section>
<section id="visualising-the-multi-channel-sequence" class="level4" data-number="4.3.3">
<h4 data-number="4.3.3" class="anchored" data-anchor-id="visualising-the-multi-channel-sequence"><span class="header-section-number">4.3.3</span> Visualising the multi-channel sequence</h4>
<p>Now that we have both channels, we can use the <code>mc_to_sc_data()</code> function from <code>seqHMM</code> to convert the two channels of engagement and achievement sequences to a single channel with an extended alphabet. If we had additional channels, we would just add them to the list.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb9"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a>multi_seq <span class="ot">&lt;-</span> <span class="fu">mc_to_sc_data</span>(<span class="fu">list</span>(eng_seq, ach_seq))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>If we check the alphabet of the sequence, we can see that it contains all combinations of engagement and achievement states.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb10"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true" tabindex="-1"></a><span class="fu">alphabet</span>(multi_seq)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "Active/Achiever"         "Active/Intermediate"    
[3] "Active/Low"              "Average/Achiever"       
[5] "Average/Intermediate"    "Average/Low"            
[7] "Disengaged/Achiever"     "Disengaged/Intermediate"
[9] "Disengaged/Low"         </code></pre>
</div>
</div>
<p>We just need to provide an appropriate colour scale where green colours represent active students, blue colours represent averagely engaged students, and red colours represent disengaged students, whereas the intensity of the colour represents the achievement level: darker colours represent higher achievement, and lighter colours represent low achievement.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb12"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb12-1"><a href="#cb12-1" aria-hidden="true" tabindex="-1"></a>coloursM <span class="ot">&lt;-</span>  <span class="fu">c</span>(<span class="st">"#115a20"</span>,<span class="st">"#24b744"</span>,<span class="st">"#78FA94"</span>,</span>
<span id="cb12-2"><a href="#cb12-2" aria-hidden="true" tabindex="-1"></a>              <span class="st">"#3659bf"</span>,<span class="st">"#309bff"</span>,<span class="st">"#93d9ff"</span>,</span>
<span id="cb12-3"><a href="#cb12-3" aria-hidden="true" tabindex="-1"></a>              <span class="st">"#E01A1A"</span>,<span class="st">"#EB8A8A"</span>,<span class="st">"#F5BDBD"</span>)</span>
<span id="cb12-4"><a href="#cb12-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-5"><a href="#cb12-5" aria-hidden="true" tabindex="-1"></a><span class="fu">cpal</span>(multi_seq) <span class="ot">&lt;-</span> coloursM</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>We can finally plot the sequence distribution and index plots for the multi-channel sequence (<a href="#fig-seqmul">Figure&nbsp;<span>13.5</span></a>). We can already hint that the students’ multi-channel sequences are quite heterogeneous. In the next steps, we will use two distinct clustering techniques to detect distinct combined trajectories of engagement and achievement, beginning with the distance-based paradigm and then the using the more sophisticated MHMM framework.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb13"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb13-1"><a href="#cb13-1" aria-hidden="true" tabindex="-1"></a><span class="fu">seqdplot</span>(multi_seq, <span class="at">border =</span> <span class="cn">NA</span>,  <span class="at">ncol =</span> <span class="dv">3</span>, <span class="at">legend.prop =</span> <span class="fl">0.2</span>)</span>
<span id="cb13-2"><a href="#cb13-2" aria-hidden="true" tabindex="-1"></a><span class="fu">seqIplot</span>(multi_seq, <span class="at">border =</span> <span class="cn">NA</span>,  <span class="at">ncol =</span> <span class="dv">3</span>, <span class="at">legend.prop =</span> <span class="fl">0.2</span>, <span class="at">sortv =</span> <span class="st">"from.start"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell" data-layout-align="center">
<div class="cell-output-display">
<div id="fig-seqmul" class="quarto-figure quarto-figure-center anchored">
<figure class="figure">
<p><img src="ch13-multi_files/figure-html/fig-seqmul-1.png" class="img-fluid figure-img" width="3750"></p>
<p></p><figcaption class="figure-caption"><strong>Figure</strong>&nbsp;5<strong>.</strong> Sequence distribution plot and index plot of the multi-channel sequence.</figcaption><p></p>
</figure>
</div>
</div>
</div>
</section>
</section>
<section id="clustering-via-multi-channel-dissimilarities" class="level3" data-number="4.4">
<h3 data-number="4.4" class="anchored" data-anchor-id="clustering-via-multi-channel-dissimilarities"><span class="header-section-number">4.4</span> Clustering via multi-channel dissimilarities</h3>
<p>We now describe how to construct a dissimilarity matrix for a combined multi-channel sequence object to use as input for distance-based clustering algorithms, using utilities provided in the <code>TraMineR</code> R package and relying on concepts described in Chapter 10. We begin by creating a list of substitution cost matrices for each of the engagement and achievement channels. For simplicity, we adopt the same method of calculating substitution costs for each channel, though this need not be the case. Here, we use the data-driven TRATE method which relies on transition rates. In other scenarios, we might want to use a constant substitution cost (same cost for all substitutions) for one of the channels and, for example, manually specify the substitution cost matrix for the other one.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb14"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb14-1"><a href="#cb14-1" aria-hidden="true" tabindex="-1"></a>sub_mats <span class="ot">&lt;-</span> <span class="fu">list</span>(<span class="at">engagement =</span> <span class="fu">seqsubm</span>(eng_seq, <span class="at">method =</span> <span class="st">"TRATE"</span>),</span>
<span id="cb14-2"><a href="#cb14-2" aria-hidden="true" tabindex="-1"></a>                 <span class="at">achievement =</span> <span class="fu">seqsubm</span>(ach_seq, <span class="at">method =</span> <span class="st">"TRATE"</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Subsequently, we invoke the function <code>seqMD()</code> to compute the multi-channel dissimilarities. This requires the constituent channels to be supplied as a list of sequence objects, along with the substitution cost matrices via the argument <code>sm</code>. The argument <code>what = "diss"</code> ensures that dissimilarities are returned, according to the OM <code>method</code>, with equal weights for each channel specified via the argument <code>cweight</code>.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb15"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb15-1"><a href="#cb15-1" aria-hidden="true" tabindex="-1"></a>channels <span class="ot">&lt;-</span> <span class="fu">list</span>(<span class="at">engagement =</span> eng_seq, <span class="at">achievement =</span> ach_seq)</span>
<span id="cb15-2"><a href="#cb15-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-3"><a href="#cb15-3" aria-hidden="true" tabindex="-1"></a>mc_dist <span class="ot">&lt;-</span> <span class="fu">seqMD</span>(channels, </span>
<span id="cb15-4"><a href="#cb15-4" aria-hidden="true" tabindex="-1"></a>                 <span class="at">sm =</span> sub_mats, </span>
<span id="cb15-5"><a href="#cb15-5" aria-hidden="true" tabindex="-1"></a>                 <span class="at">what =</span> <span class="st">"diss"</span>, </span>
<span id="cb15-6"><a href="#cb15-6" aria-hidden="true" tabindex="-1"></a>                 <span class="at">method =</span> <span class="st">"OM"</span>, </span>
<span id="cb15-7"><a href="#cb15-7" aria-hidden="true" tabindex="-1"></a>                 <span class="at">cweight =</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">1</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Thereafter, <code>mc_dist</code> can be used as input to any distance-based clustering algorithm. Though we are not limited to doing so, we follow Chapter 10 in applying hierarchical clustering with Ward’s criterion. However, we note that users of the distance-based paradigm are not limited to Ward’s criterion or hierarchical clustering itself either.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb16"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb16-1"><a href="#cb16-1" aria-hidden="true" tabindex="-1"></a>Clustered <span class="ot">&lt;-</span> <span class="fu">hclust</span>(<span class="fu">as.dist</span>(mc_dist), <span class="at">method =</span> <span class="st">"ward.D2"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>We then obtain the implied clusters by cutting the produced tree using the <code>cutree()</code> function, where the argument <code>k</code> indicated the desired number of clusters. We also create more descriptive labels for each cluster.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb17"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb17-1"><a href="#cb17-1" aria-hidden="true" tabindex="-1"></a>Cuts <span class="ot">&lt;-</span> <span class="fu">cutree</span>(Clustered, <span class="at">k =</span> <span class="dv">6</span>)</span>
<span id="cb17-2"><a href="#cb17-2" aria-hidden="true" tabindex="-1"></a>Groups <span class="ot">&lt;-</span> <span class="fu">factor</span>(Cuts, <span class="at">labels =</span> <span class="fu">paste</span>(<span class="st">"Cluster"</span>, <span class="dv">1</span><span class="sc">:</span><span class="dv">6</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Generally speaking, the resulting clusters for the chosen <code>k</code> value may not represent the best solution. In an ideal analysis, one would resort to one or more of the cluster quality measures given in Table 9 of Chapter 10 to inform the choice of an optimal <code>k</code> value. In doing so, we determined the chosen number of six clusters is optimal according to the average silhouette width (ASW) criterion therein (see Chapter 10). However, we omit the details of these steps here for brevity and leave them as an exercise for the interested reader.</p>
<p>The obtained <code>Groups</code> can be used to produce visualisations of the clustering solution. We do so in two ways; first showing the combined multi-channel object with an extended alphabet (as per <a href="#fig-multi2">Figure&nbsp;<span>13.2</span></a>) using the <code>seqplot()</code> function from <code>TraMiner</code> in <a href="#fig-statd-multi">Figure&nbsp;<span>13.6</span></a>, and second using a stacked representation of both constituent channels using the <code>ssp()</code> and <code>gridplot()</code> functions from <code>seqHMM</code> in <a href="#fig-statd-stacked">Figure&nbsp;<span>13.7</span></a>. State distribution plots per cluster are depicted in each case.</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb18"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb18-1"><a href="#cb18-1" aria-hidden="true" tabindex="-1"></a><span class="fu">seqplot</span>(multi_seq, <span class="at">type =</span> <span class="st">"d"</span>, <span class="at">group =</span> Groups, </span>
<span id="cb18-2"><a href="#cb18-2" aria-hidden="true" tabindex="-1"></a>         <span class="at">ncol =</span> <span class="dv">3</span>, <span class="at">legend.prop =</span> <span class="fl">0.1</span>, <span class="at">border =</span> <span class="cn">NA</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div id="fig-statd-multi" class="quarto-figure quarto-figure-center anchored">
<figure class="figure">
<p><img src="ch13-multi_files/figure-html/fig-statd-multi-1.png" class="img-fluid figure-img" style="width:6in"></p>
<p></p><figcaption class="figure-caption"><strong>Figure</strong>&nbsp;6<strong>.</strong> State distribution plots per cluster for the combined multi-channel sequences.</figcaption><p></p>
</figure>
</div>
</div>
</div>
<p>Though there is some evidence of well-defined clusters capturing different engagement and achievement levels over time, a plot such as this can be difficult to interpret, even for a small number of channels and small numbers of per-channel states. A more visually appealing alternative is provided by the stacked state distribution plots below, which shows each individual channel with its own alphabet on the same plot, with one such plot per cluster. This requires supplying a list of the observations ìn each cluster in each channel to the <code>ssp()</code> function to create each plot, with each plot then arranged and displayed appropriately by the function <code>gridplot()</code>.</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb19"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb19-1"><a href="#cb19-1" aria-hidden="true" tabindex="-1"></a>ssp_k <span class="ot">&lt;-</span> <span class="fu">list</span>()</span>
<span id="cb19-2"><a href="#cb19-2" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span>(k <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">6</span>) {</span>
<span id="cb19-3"><a href="#cb19-3" aria-hidden="true" tabindex="-1"></a>  ssp_k[[k]] <span class="ot">&lt;-</span> <span class="fu">ssp</span>(<span class="fu">list</span>(eng_seq[Cuts <span class="sc">==</span> k,], </span>
<span id="cb19-4"><a href="#cb19-4" aria-hidden="true" tabindex="-1"></a>                         ach_seq[Cuts <span class="sc">==</span> k,]),</span>
<span id="cb19-5"><a href="#cb19-5" aria-hidden="true" tabindex="-1"></a>                    <span class="at">type =</span> <span class="st">"d"</span>, <span class="at">border =</span> <span class="cn">NA</span>, </span>
<span id="cb19-6"><a href="#cb19-6" aria-hidden="true" tabindex="-1"></a>                    <span class="at">with.legend =</span> <span class="cn">FALSE</span>, <span class="at">title =</span> <span class="fu">levels</span>(Groups)[k])</span>
<span id="cb19-7"><a href="#cb19-7" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb19-8"><a href="#cb19-8" aria-hidden="true" tabindex="-1"></a><span class="fu">gridplot</span>(ssp_k, <span class="at">ncol =</span> <span class="dv">3</span>, <span class="at">byrow =</span> <span class="cn">TRUE</span>, </span>
<span id="cb19-9"><a href="#cb19-9" aria-hidden="true" tabindex="-1"></a>         <span class="at">row.prop =</span> <span class="fu">c</span>(<span class="fl">0.4</span>, <span class="fl">0.4</span>, <span class="fl">0.2</span>), <span class="at">cex.legend =</span> <span class="fl">0.8</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div id="fig-statd-stacked" class="quarto-figure quarto-figure-center anchored">
<figure class="figure">
<p><img src="ch13-multi_files/figure-html/fig-statd-stacked-1.png" class="img-fluid figure-img" width="3000"></p>
<p></p><figcaption class="figure-caption"><strong>Figure</strong>&nbsp;7<strong>.</strong> Stacked state distribution plots per cluster showing both constituent channels.</figcaption><p></p>
</figure>
</div>
</div>
</div>
<p>From this plot, we can see six clusters, relating respectively to 1) mostly averagely engaged high achievers, 2) mostly actively engaged intermediate achievers, 3) mostly disengaged intermediate or high achievement, 4) mostly averagely engaged low achievers, 5) mostly disengaged low achievers, and 6) mostly actively engage high achievers. This clustering approach and this set of plots provides quite a granular view of the group structure and interdependencies across channels, which differs somewhat from the clustering solution obtained by the application of MHMMs which now follows.</p>
<p>Before we move on to the next clustering approach, it might be useful to learn how to extract the clustering assignment of each student to be able to conduct further analyses. The <code>Groups</code> vector that we created based on the results of the clustering process is in the same order as the engagement and achievement sequences, and therefore, of the dataframes used to create the sequences. As such, we can simply create a new column in one of the dataframes (e.g., <code>eng_seq_df</code>) and assign the <code>Groups</code> variable as follows:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb20"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb20-1"><a href="#cb20-1" aria-hidden="true" tabindex="-1"></a>eng_seq_df<span class="sc">$</span>ClusterDistance <span class="ot">=</span> Groups</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="building-a-mixture-hidden-markov-model" class="level3" data-number="4.5">
<h3 data-number="4.5" class="anchored" data-anchor-id="building-a-mixture-hidden-markov-model"><span class="header-section-number">4.5</span> Building a mixture hidden Markov model</h3>
<p>The <code>seqHMM</code> package supports several types of (hidden) Markov models for single- or multi-channel sequences of data. The package provides functions for evaluating and comparing models, and methods for the visualisation of multi-channel sequence data and hidden Markov models. The models are estimated through maximum likelihood, using the Expectation Maximisation (EM) algorithm and/or direct numerical maximisation with analytical gradients. For more details on the <code>seqHMM</code> package, refer to the “Markov models” chapter. We are going to construct a mixture hidden Markov model (MHMM). For this purpose, we will rely on the <code>build_mhmm()</code> function of <code>seqHMM</code>. In its most basic form, the <code>build_mhmm()</code> function takes as arguments a list of <code>observations</code> (i.e., a list of the sequences that make up the channels), and a vector <code>n_states</code> whose length indicates the number of clusters to estimate, for which the value of each position specifies the number of hidden states in each cluster. The <code>build_mhmm()</code> function defines that structure of the model (including possible restrictions) and also assigns random or user-defined starting values to model parameters for estimation. Though we are not restricted to assuming all clusters have an equal number of hidden states, we are going to build a model with 3 clusters and 2 hidden states per cluster, inspired by the results obtained in the previous section (i.e., 6 clusters). Therefore, our input for <code>n_states</code> is <code>c(2, 2, 2)</code>. If instead, we wanted to build a model with 4 clusters and 3 hidden states, we would need to provide <code>c(3, 3, 3, 3)</code>.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb21"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb21-1"><a href="#cb21-1" aria-hidden="true" tabindex="-1"></a>init_mhmm <span class="ot">&lt;-</span> <span class="fu">build_mhmm</span>(<span class="at">observations =</span> <span class="fu">list</span>(eng_seq, ach_seq), </span>
<span id="cb21-2"><a href="#cb21-2" aria-hidden="true" tabindex="-1"></a>                        <span class="at">n_states =</span> <span class="fu">c</span>(<span class="dv">2</span>, <span class="dv">2</span>, <span class="dv">2</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Now we can fit the model using the <code>fit_model()</code> function. Using the EM algorithm and the <code>times</code> argument, we can provide a number to control the number of times the model should be fit in a hope to find the globally optimal solution. We need to find a number that is not too low (or else we might be settling for a non-optimal solution too early) but also not too high (or the code will take forever to run). If we provide <code>100</code>, for example, the model will be estimated 101 times: once from the user-defined or random starting values at the build stage and then 100 re-estimations with randomized starting values. The function will give the best model as an output. Generally, the more complex the model, the more re-estimation rounds are needed.</p>
<div class="cell" data-hash="ch13-multi_cache/html/unnamed-chunk-26_f750a9e8476b4c5b7e12df30c166ff03">
<div class="sourceCode cell-code" id="cb22"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb22-1"><a href="#cb22-1" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">2294</span>)</span>
<span id="cb22-2"><a href="#cb22-2" aria-hidden="true" tabindex="-1"></a>mhmm_fit <span class="ot">&lt;-</span> <span class="fu">fit_model</span>(init_mhmm, </span>
<span id="cb22-3"><a href="#cb22-3" aria-hidden="true" tabindex="-1"></a>                      <span class="at">control_em =</span> <span class="fu">list</span>(<span class="at">restart =</span> <span class="fu">list</span>(<span class="at">times =</span> <span class="dv">100</span>)))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Once the function has finished fitting the model, we need to check if it has likely reached the optimal solution. We can do so by checking the variable <code>mhmm_fit$em_results$best_opt_restart</code> of the fitted model. For the results to be reliable, we would expect to find the best-fitting model a number of times from different starting values. In other words, we want to see the same value repeating at the beginning of the sequence of numbers returned by <code>mhmm_fit$em_results$best_opt_restart</code> for several times if we estimate the model 100 times. In this case, we observe the same number quite many times, so the stability of our results is acceptable. If the same number does not appear several times, we can increase the number provided to the <code>times</code> argument or we can provide more informative starting values (for example, using the parameters of the newly fitted suboptimal model as starting values for the new estimation).</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb23"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb23-1"><a href="#cb23-1" aria-hidden="true" tabindex="-1"></a>mhmm_fit<span class="sc">$</span>em_results<span class="sc">$</span>best_opt_restart</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code> [1] -1659.712 -1659.712 -1659.712 -1659.712 -1659.712 -1659.712 -1659.712
 [8] -1659.712 -1659.712 -1659.712 -1659.712 -1659.712 -1659.712 -1659.712
[15] -1659.712 -1659.712 -1659.712 -1659.712 -1659.712 -1659.712 -1659.712
[22] -1659.712 -1659.712 -1659.712 -1659.712</code></pre>
</div>
</div>
<p>Now we can plot our results using the <code>mssplot()</code> function. <a href="#fig-traj1-initial">Figure&nbsp;<span>13.8</span></a> shows index plots for each of the three fitted clusters. These plots show the categories at each time point within each cluster, as well as the hidden states. We can see that Cluster 1 corresponds to students who are mostly low achievers, wherein State 1 represents students who are disengaged and State 2 represents students who are averagely engaged. Cluster 2 includes the Active students who are mostly high achievers (State 2), or intermediate achievers (State 1). Cluster 3 represents mostly low achievers, where State 1 mostly represents the disengaged and State 2 the mostly averagely engaged. Therefore, the results are quite interpretable and make sense given our data.</p>
<div>
<div class="sourceCode cell-code" id="cb25"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb25-1"><a href="#cb25-1" aria-hidden="true" tabindex="-1"></a>HIDDEN_STATES <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"darkred"</span>, <span class="st">"pink"</span>, <span class="st">"darkblue"</span>, <span class="st">"purple"</span>, </span>
<span id="cb25-2"><a href="#cb25-2" aria-hidden="true" tabindex="-1"></a>                   <span class="st">"lightgoldenrod1"</span>, <span class="st">"orange"</span>)</span>
<span id="cb25-3"><a href="#cb25-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb25-4"><a href="#cb25-4" aria-hidden="true" tabindex="-1"></a><span class="fu">mssplot</span>(mhmm_fit<span class="sc">$</span>model,  </span>
<span id="cb25-5"><a href="#cb25-5" aria-hidden="true" tabindex="-1"></a>        <span class="at">plots =</span> <span class="st">"both"</span>, </span>
<span id="cb25-6"><a href="#cb25-6" aria-hidden="true" tabindex="-1"></a>        <span class="at">type =</span> <span class="st">"I"</span>, </span>
<span id="cb25-7"><a href="#cb25-7" aria-hidden="true" tabindex="-1"></a>        <span class="at">sortv =</span> <span class="st">"mds.hidden"</span>,</span>
<span id="cb25-8"><a href="#cb25-8" aria-hidden="true" tabindex="-1"></a>        <span class="at">yaxis =</span> <span class="cn">TRUE</span>, </span>
<span id="cb25-9"><a href="#cb25-9" aria-hidden="true" tabindex="-1"></a>        <span class="at">with.legend =</span> <span class="st">"bottom"</span>,</span>
<span id="cb25-10"><a href="#cb25-10" aria-hidden="true" tabindex="-1"></a>        <span class="at">ncol.legend =</span> <span class="dv">1</span>,</span>
<span id="cb25-11"><a href="#cb25-11" aria-hidden="true" tabindex="-1"></a>        <span class="at">cex.title =</span> <span class="fl">1.3</span>,</span>
<span id="cb25-12"><a href="#cb25-12" aria-hidden="true" tabindex="-1"></a>        <span class="at">hidden.states.colors =</span> HIDDEN_STATES)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div id="fig-traj1-initial" class="cell quarto-layout-panel">
<figure class="figure">
<div class="quarto-layout-row quarto-layout-valign-top">
<div class="cell-output-display quarto-layout-cell quarto-layout-cell-subref" style="flex-basis: 33.3%;justify-content: center;">
<div id="fig-traj1-initial-1" class="quarto-figure quarto-figure-center anchored">
<figure class="figure">
<p><img src="ch13-multi_files/figure-html/fig-traj1-initial-1.png" class="img-fluid figure-img" data-ref-parent="fig-traj1-initial" width="1080"></p>
<p></p><figcaption class="figure-caption">(a) Cluster 1.</figcaption><p></p>
</figure>
</div>
</div>
<div class="cell-output-display quarto-layout-cell quarto-layout-cell-subref" style="flex-basis: 33.3%;justify-content: center;">
<div id="fig-traj1-initial-2" class="quarto-figure quarto-figure-center anchored">
<figure class="figure">
<p><img src="ch13-multi_files/figure-html/fig-traj1-initial-2.png" class="img-fluid figure-img" data-ref-parent="fig-traj1-initial" width="1080"></p>
<p></p><figcaption class="figure-caption">(b) Cluster 2.</figcaption><p></p>
</figure>
</div>
</div>
<div class="cell-output-display quarto-layout-cell quarto-layout-cell-subref" style="flex-basis: 33.3%;justify-content: center;">
<div id="fig-traj1-initial-3" class="quarto-figure quarto-figure-center anchored">
<figure class="figure">
<p><img src="ch13-multi_files/figure-html/fig-traj1-initial-3.png" class="img-fluid figure-img" data-ref-parent="fig-traj1-initial" width="1080"></p>
<p></p><figcaption class="figure-caption">(c) Cluster 3.</figcaption><p></p>
</figure>
</div>
</div>
</div>
<p></p><figcaption class="figure-caption"><strong>Figure</strong>&nbsp;8<strong>.</strong> Multi-channel sequence index plots.</figcaption><p></p>
</figure>
</div>
</div>
<p>We may also plot the transitions between the hidden states for each cluster using the <code>plot()</code> function (<a href="#fig-pie">Figure&nbsp;<span>13.9</span></a>). Most arguments used here are purely cosmetic in nature, with the exception of <code>combine.slice</code> which corresponds to the highest probability for which emission probabilities are combined into one state. We adopt the default value of 0.05 to aid the legibility of the plots. We see that the probabilities of starting at each hidden state (initial probabilities), as shown at the bottom of each pie chart, are quite balanced: 0.61/0.39, 0.58/0.42, 0.62/0.38. The transition probabilities (i.e., the probabilities of transitioning from one hidden state to another within the same cluster) are in turn quite low (all &lt; 0.07), meaning that in most cases students remain in the same hidden state throughout their whole academic trajectory. Lastly, the emission probabilities (i.e., the probabilities of each state within each hidden state) are quite diverse, where some hidden states are quite homogeneous (e.g, State 2 in Cluster 2 has a 0.84 probability of having Disengaged students) whereas others are more evenly distributed among all states (e.g., State 1 in Cluster 3).</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb26"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb26-1"><a href="#cb26-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(mhmm_fit<span class="sc">$</span>model, </span>
<span id="cb26-2"><a href="#cb26-2" aria-hidden="true" tabindex="-1"></a>     <span class="at">vertex.size =</span> <span class="dv">60</span>,</span>
<span id="cb26-3"><a href="#cb26-3" aria-hidden="true" tabindex="-1"></a>     <span class="at">cpal =</span> coloursM, </span>
<span id="cb26-4"><a href="#cb26-4" aria-hidden="true" tabindex="-1"></a>     <span class="at">label.color =</span> <span class="st">"black"</span>,</span>
<span id="cb26-5"><a href="#cb26-5" aria-hidden="true" tabindex="-1"></a>     <span class="at">vertex.label.color =</span> <span class="st">"black"</span>,</span>
<span id="cb26-6"><a href="#cb26-6" aria-hidden="true" tabindex="-1"></a>     <span class="at">edge.color =</span> <span class="st">"lightgray"</span>,</span>
<span id="cb26-7"><a href="#cb26-7" aria-hidden="true" tabindex="-1"></a>     <span class="at">edge.label.color =</span> <span class="st">"black"</span>,</span>
<span id="cb26-8"><a href="#cb26-8" aria-hidden="true" tabindex="-1"></a>     <span class="at">ncol.legend =</span> <span class="dv">1</span>, </span>
<span id="cb26-9"><a href="#cb26-9" aria-hidden="true" tabindex="-1"></a>     <span class="at">ncol =</span> <span class="dv">3</span>,</span>
<span id="cb26-10"><a href="#cb26-10" aria-hidden="true" tabindex="-1"></a>     <span class="at">rescale =</span> <span class="cn">FALSE</span>,</span>
<span id="cb26-11"><a href="#cb26-11" aria-hidden="true" tabindex="-1"></a>     <span class="at">interactive =</span> <span class="cn">FALSE</span>,</span>
<span id="cb26-12"><a href="#cb26-12" aria-hidden="true" tabindex="-1"></a>     <span class="at">combine.slices =</span> <span class="fl">0.05</span>,</span>
<span id="cb26-13"><a href="#cb26-13" aria-hidden="true" tabindex="-1"></a>     <span class="at">combined.slice.label =</span> <span class="st">"States with probability &lt; 0.05"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div id="fig-pie" class="quarto-figure quarto-figure-center anchored">
<figure class="figure">
<p><img src="ch13-multi_files/figure-html/fig-pie-1.png" class="img-fluid figure-img" width="800"></p>
<p></p><figcaption class="figure-caption"><strong>Figure</strong>&nbsp;9<strong>.</strong> Transitions between hidden states for each trajectory.</figcaption><p></p>
</figure>
</div>
</div>
</div>
<p>In the previous example, we have used <code>build_mhmm()</code> with the default values in which we only need to provide the number of clusters and hidden states. However, the function allows much more flexibility by allowing us to constrain the different probabilities (initial, transition, and emission) that we have just talked about. An interesting case study can be to investigate how students who start in the same hidden state evolve throughout their academic trajectory; whether they remain in the same hidden state or switch to a different one. To do that, we would need to fix the initial probabilities to be 1 for the first hidden state, and 0 for the other. To do this for the three clusters, we need to create a list with the vector <code>c(1, 0)</code> repeated three times. For the initial transition and emission probabilities, we can just simulate random ones using the functions <code>simulate_transition_probs()</code> and <code>simulate_emission_probs()</code> respectively. It is worth noting that in the previous MHMM example, when we fitted the model using the default probabilities, we just needed to provide the number of clusters and hidden states. However, now that we need to fix the initial probabilities, we also need to simulate the transition and emission probabilities using the corresponding functions.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb27"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb27-1"><a href="#cb27-1" aria-hidden="true" tabindex="-1"></a>initial_probs <span class="ot">&lt;-</span> <span class="fu">list</span>(<span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">0</span>), <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">0</span>), <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">0</span>))</span>
<span id="cb27-2"><a href="#cb27-2" aria-hidden="true" tabindex="-1"></a>transition_probs <span class="ot">&lt;-</span> <span class="fu">simulate_transition_probs</span>(<span class="at">n_states =</span> <span class="dv">2</span>, </span>
<span id="cb27-3"><a href="#cb27-3" aria-hidden="true" tabindex="-1"></a>                                              <span class="at">n_clusters =</span> <span class="dv">3</span>, </span>
<span id="cb27-4"><a href="#cb27-4" aria-hidden="true" tabindex="-1"></a>                                              <span class="at">left_right =</span> <span class="cn">TRUE</span>)</span>
<span id="cb27-5"><a href="#cb27-5" aria-hidden="true" tabindex="-1"></a>emission_probs <span class="ot">&lt;-</span> <span class="fu">simulate_emission_probs</span>(<span class="at">n_states =</span> <span class="dv">2</span>, </span>
<span id="cb27-6"><a href="#cb27-6" aria-hidden="true" tabindex="-1"></a>                                          <span class="at">n_symbols =</span> <span class="dv">3</span>, </span>
<span id="cb27-7"><a href="#cb27-7" aria-hidden="true" tabindex="-1"></a>                                          <span class="at">n_clusters =</span> <span class="dv">1</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>We must now provide the probability objects to the <code>build_mhmm()</code> function along with the observations. Since the number of clusters and hidden states can be derived from the probabilities, we no longer need to provide the <code>n_states</code> argument. Specifically, this is because <code>emission_probs</code> is given as a list of length 3 with each element being a list of length 2, corresponding to three clusters each with two hidden states per cluster, as before. This new model is fitted in the same way, by using the <code>fit_model()</code> function.</p>
<div class="cell" data-hash="ch13-multi_cache/html/unnamed-chunk-31_6a77016b4f1fcd17f5d4d0ffc89fd585">
<div class="sourceCode cell-code" id="cb28"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb28-1"><a href="#cb28-1" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">2294</span>)</span>
<span id="cb28-2"><a href="#cb28-2" aria-hidden="true" tabindex="-1"></a>init_emission_probs <span class="ot">&lt;-</span> <span class="fu">list</span>(<span class="fu">list</span>(emission_probs, emission_probs),</span>
<span id="cb28-3"><a href="#cb28-3" aria-hidden="true" tabindex="-1"></a>                            <span class="fu">list</span>(emission_probs, emission_probs),</span>
<span id="cb28-4"><a href="#cb28-4" aria-hidden="true" tabindex="-1"></a>                            <span class="fu">list</span>(emission_probs, emission_probs))</span>
<span id="cb28-5"><a href="#cb28-5" aria-hidden="true" tabindex="-1"></a>init_mhmm_i <span class="ot">&lt;-</span> <span class="fu">build_mhmm</span>(<span class="at">observations =</span> <span class="fu">list</span>(eng_seq, ach_seq), </span>
<span id="cb28-6"><a href="#cb28-6" aria-hidden="true" tabindex="-1"></a>                          <span class="at">initial_probs =</span> initial_probs, </span>
<span id="cb28-7"><a href="#cb28-7" aria-hidden="true" tabindex="-1"></a>                          <span class="at">transition_probs =</span> transition_probs, </span>
<span id="cb28-8"><a href="#cb28-8" aria-hidden="true" tabindex="-1"></a>                          <span class="at">emission_probs =</span> init_emission_probs)</span>
<span id="cb28-9"><a href="#cb28-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-10"><a href="#cb28-10" aria-hidden="true" tabindex="-1"></a>mhmm_fit_i <span class="ot">&lt;-</span> <span class="fu">fit_model</span>(init_mhmm_i, </span>
<span id="cb28-11"><a href="#cb28-11" aria-hidden="true" tabindex="-1"></a>                        <span class="at">control_em =</span> <span class="fu">list</span>(<span class="at">restart =</span> <span class="fu">list</span>(<span class="at">times =</span> <span class="dv">200</span>)))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Again, we need to check whether the model has converged to a valid solution by checking if the same number is repeated at the beginning of the <code>best_opt_start</code> output:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb29"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb29-1"><a href="#cb29-1" aria-hidden="true" tabindex="-1"></a>mhmm_fit_i<span class="sc">$</span>em_results<span class="sc">$</span>best_opt_restart</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code> [1] -1726.463 -1726.463 -1726.463 -1726.463 -1726.463 -1726.463 -1726.463
 [8] -1726.463 -1726.463 -1726.463 -1726.463 -1726.463 -1726.463 -1726.463
[15] -1726.463 -1726.463 -1726.463 -1726.463 -1726.463 -1726.463 -1735.624
[22] -1735.624 -1735.624 -1735.624 -1735.624</code></pre>
</div>
</div>
<p>Now that we have checked that our model is correct, we can give the channels and clusters representative names so that they look better when plotting:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb31"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb31-1"><a href="#cb31-1" aria-hidden="true" tabindex="-1"></a>mhmm_fit_i<span class="sc">$</span>model<span class="sc">$</span>cluster_names <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"Trajectory 1"</span>,</span>
<span id="cb31-2"><a href="#cb31-2" aria-hidden="true" tabindex="-1"></a>                                    <span class="st">"Trajectory 2"</span>, </span>
<span id="cb31-3"><a href="#cb31-3" aria-hidden="true" tabindex="-1"></a>                                    <span class="st">"Trajectory 3"</span>)</span>
<span id="cb31-4"><a href="#cb31-4" aria-hidden="true" tabindex="-1"></a>mhmm_fit_i<span class="sc">$</span>model<span class="sc">$</span>channel_names <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"Engagement"</span>,</span>
<span id="cb31-5"><a href="#cb31-5" aria-hidden="true" tabindex="-1"></a>                                    <span class="st">"Achievement"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Now we may plot our results, as before, in the form of sequence index plots (see <a href="#fig-trajec-1">Figure&nbsp;<span>13.10 (a)</span></a>, <a href="#fig-trajec-2">Figure&nbsp;<span>13.10 (b)</span></a>, and <a href="#fig-trajec-3">Figure&nbsp;<span>13.10 (c)</span></a>). We see that —due to the specified initial probabilities— all clusters start with the same hidden state and mostly remain there throughout the whole trajectory, although some students switch to the other hidden state as time advances. In Cluster 1, students are mostly low achievers and start by being mostly averagely engaged (State 1), while some transition to disengaged (State 2). In Cluster 2, students are mostly highly engaged and start being high achievers (State 1), while some students transition to being mostly intermediate achievers (State 2). Lastly, in Cluster 3, students are mostly averagely engaged or disengaged high or intermediate achievers (State 1), while a small fraction of students become more averagely engaged and more highly achieving over time (State 2).</p>
<div>
<div class="sourceCode cell-code" id="cb32"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb32-1"><a href="#cb32-1" aria-hidden="true" tabindex="-1"></a>HIDDEN_STATES <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"darkred"</span>, <span class="st">"pink"</span>, <span class="st">"darkblue"</span>, <span class="st">"purple"</span>, </span>
<span id="cb32-2"><a href="#cb32-2" aria-hidden="true" tabindex="-1"></a>                   <span class="st">"lightgoldenrod1"</span>, <span class="st">"orange"</span>)</span>
<span id="cb32-3"><a href="#cb32-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-4"><a href="#cb32-4" aria-hidden="true" tabindex="-1"></a><span class="fu">mssplot</span>(mhmm_fit_i<span class="sc">$</span>model,  </span>
<span id="cb32-5"><a href="#cb32-5" aria-hidden="true" tabindex="-1"></a>        <span class="at">plots =</span> <span class="st">"both"</span>, </span>
<span id="cb32-6"><a href="#cb32-6" aria-hidden="true" tabindex="-1"></a>        <span class="at">type =</span> <span class="st">"I"</span>, </span>
<span id="cb32-7"><a href="#cb32-7" aria-hidden="true" tabindex="-1"></a>        <span class="at">sortv =</span> <span class="st">"mds.hidden"</span>,</span>
<span id="cb32-8"><a href="#cb32-8" aria-hidden="true" tabindex="-1"></a>        <span class="at">yaxis =</span> <span class="cn">TRUE</span>, </span>
<span id="cb32-9"><a href="#cb32-9" aria-hidden="true" tabindex="-1"></a>        <span class="at">with.legend =</span> <span class="st">"bottom"</span>,</span>
<span id="cb32-10"><a href="#cb32-10" aria-hidden="true" tabindex="-1"></a>        <span class="at">ncol.legend =</span> <span class="dv">1</span>,</span>
<span id="cb32-11"><a href="#cb32-11" aria-hidden="true" tabindex="-1"></a>        <span class="at">cex.title =</span> <span class="fl">1.3</span>,</span>
<span id="cb32-12"><a href="#cb32-12" aria-hidden="true" tabindex="-1"></a>        <span class="at">hidden.states.colors =</span> HIDDEN_STATES)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div id="fig-trajec" class="cell quarto-layout-panel">
<figure class="figure">
<div class="quarto-layout-row quarto-layout-valign-top">
<div class="cell-output-display quarto-layout-cell quarto-layout-cell-subref" style="flex-basis: 33.3%;justify-content: center;">
<div id="fig-trajec-1" class="quarto-figure quarto-figure-center anchored">
<figure class="figure">
<p><img src="ch13-multi_files/figure-html/fig-trajec-1.png" class="img-fluid figure-img" data-ref-parent="fig-trajec" width="1080"></p>
<p></p><figcaption class="figure-caption">(a) Trajectory 1.</figcaption><p></p>
</figure>
</div>
</div>
<div class="cell-output-display quarto-layout-cell quarto-layout-cell-subref" style="flex-basis: 33.3%;justify-content: center;">
<div id="fig-trajec-2" class="quarto-figure quarto-figure-center anchored">
<figure class="figure">
<p><img src="ch13-multi_files/figure-html/fig-trajec-2.png" class="img-fluid figure-img" data-ref-parent="fig-trajec" width="1080"></p>
<p></p><figcaption class="figure-caption">(b) Trajectory 2.</figcaption><p></p>
</figure>
</div>
</div>
<div class="cell-output-display quarto-layout-cell quarto-layout-cell-subref" style="flex-basis: 33.3%;justify-content: center;">
<div id="fig-trajec-3" class="quarto-figure quarto-figure-center anchored">
<figure class="figure">
<p><img src="ch13-multi_files/figure-html/fig-trajec-3.png" class="img-fluid figure-img" data-ref-parent="fig-trajec" width="1080"></p>
<p></p><figcaption class="figure-caption">(c) Trajectory 3.</figcaption><p></p>
</figure>
</div>
</div>
</div>
<p></p><figcaption class="figure-caption"><strong>Figure</strong>&nbsp;10<strong>.</strong> Multi-channel sequence index plots with fixed start.</figcaption><p></p>
</figure>
</div>
</div>
<p>There are countless combinations of numbers of clusters, hidden states, and initial/transition/emission probabilities that we can use to fit our model. The choice depends on our data, our research question, the interpretability of the results, and the goodness of fit. Regarding the latter, a common way to compare the performance of several models is by using the Bayesian Information Criterion (BIC; <span class="citation" data-cites="schwarz1978">[<a href="../ch01-intro/intro.html#ref-schwarz1978" role="doc-biblioref">19</a>]</span>). The BIC can help us score the models which better fit our data while penalising us if we overfit it by adding too many parameters (e.g, if we specified 50 clusters instead of 3, we would better capture the variability of our data but our model would hardly generalise to other scenarios). Therefore, as a general rule, the lower the BIC the better the model, although we need to take into account the aforementioned issues (research questions, interpretability, etc.) to make the final choice. Below we show an example of how to calculate the BIC of the models we have estimated. We see that the first model with the fixed initial probabilities has a somewhat higher BIC than the second one with the restricted initial probabilities. However, we might need to try different numbers of clusters and hidden states to make our final choice.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb33"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb33-1"><a href="#cb33-1" aria-hidden="true" tabindex="-1"></a><span class="fu">BIC</span>(mhmm_fit<span class="sc">$</span>model)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 3565.658</code></pre>
</div>
<div class="sourceCode cell-code" id="cb35"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb35-1"><a href="#cb35-1" aria-hidden="true" tabindex="-1"></a><span class="fu">BIC</span>(mhmm_fit_i<span class="sc">$</span>model)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 3656.949</code></pre>
</div>
</div>
</section>
<section id="incorporating-covariates-in-mhmms" class="level3" data-number="4.6">
<h3 data-number="4.6" class="anchored" data-anchor-id="incorporating-covariates-in-mhmms"><span class="header-section-number">4.6</span> Incorporating covariates in MHMMs</h3>
<p>The BIC can also be used to select the optimal model when different candidate models with different subsets of covariates are fitted. Recall that the clustering and the relation of clusters to covariates is performed simultaneously. Thus, otherwise identical models without dependence on covariates, or using different covariates, may uncover different groupings with different probabilities and hence a different BIC score. Here, we take the optimal model –with three clusters, each with two hidden states, using fixed initial probabilities– and demonstrate how to add and select covariates to make the model more powerful and interpretable. We begin by extract the covariate information from the original, long format <code>df</code>. For each student, the available time-constant covariates are a numeric variable giving their previous grades from an earlier course, a numeric measure of their attitude towards learning, and their gender (male or female). The order of the rows of <code>cov_df</code> matches the order in the two <code>eng_seq</code> and <code>ach_seq</code> channels.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb37"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb37-1"><a href="#cb37-1" aria-hidden="true" tabindex="-1"></a>cov_df <span class="ot">&lt;-</span> df <span class="sc">|&gt;</span> </span>
<span id="cb37-2"><a href="#cb37-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">arrange</span>(UserID, Sequence) <span class="sc">|&gt;</span> </span>
<span id="cb37-3"><a href="#cb37-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="sc">!</span><span class="fu">duplicated</span>(UserID)) <span class="sc">|&gt;</span> </span>
<span id="cb37-4"><a href="#cb37-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(Prev_grade, Attitude, Gender)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>The code below replicates the code used to fit the previously optimal MHMM model, and augments it by providing a data frame (via the <code>data</code> argument, using the <code>cov_df</code> just created) and the corresponding one-sided formula for specifying the covariates to include (via the <code>formula</code> argument). For simplicity, we keep the same number of clusters and hidden states and fit three models (one for each covariate in <code>cov_df</code>). To mitigate against convergence issues, we use the results of the previously optimal MHMM to provide informative starting values.</p>
<div class="cell" data-hash="ch13-multi_cache/html/unnamed-chunk-37_6915884fa591022a7b486cea300b24c0">
<div class="sourceCode cell-code" id="cb38"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb38-1"><a href="#cb38-1" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">2294</span>)</span>
<span id="cb38-2"><a href="#cb38-2" aria-hidden="true" tabindex="-1"></a>init_mhmm_1 <span class="ot">&lt;-</span> <span class="fu">build_mhmm</span>(<span class="at">observations =</span> <span class="fu">list</span>(eng_seq, ach_seq), </span>
<span id="cb38-3"><a href="#cb38-3" aria-hidden="true" tabindex="-1"></a>                          <span class="at">initial_probs =</span> mhmm_fit_i<span class="sc">$</span>model<span class="sc">$</span>initial_probs, </span>
<span id="cb38-4"><a href="#cb38-4" aria-hidden="true" tabindex="-1"></a>                          <span class="at">transition_probs =</span> mhmm_fit_i<span class="sc">$</span>model<span class="sc">$</span>transition_probs, </span>
<span id="cb38-5"><a href="#cb38-5" aria-hidden="true" tabindex="-1"></a>                          <span class="at">emission_probs =</span> mhmm_fit_i<span class="sc">$</span>model<span class="sc">$</span>emission_probs,</span>
<span id="cb38-6"><a href="#cb38-6" aria-hidden="true" tabindex="-1"></a>                          <span class="at">data =</span> cov_df,</span>
<span id="cb38-7"><a href="#cb38-7" aria-hidden="true" tabindex="-1"></a>                          <span class="at">formula =</span> <span class="sc">~</span> Prev_grade)</span>
<span id="cb38-8"><a href="#cb38-8" aria-hidden="true" tabindex="-1"></a>init_mhmm_2 <span class="ot">&lt;-</span> <span class="fu">build_mhmm</span>(<span class="at">observations =</span> <span class="fu">list</span>(eng_seq, ach_seq), </span>
<span id="cb38-9"><a href="#cb38-9" aria-hidden="true" tabindex="-1"></a>                          <span class="at">initial_probs =</span> mhmm_fit_i<span class="sc">$</span>model<span class="sc">$</span>initial_probs, </span>
<span id="cb38-10"><a href="#cb38-10" aria-hidden="true" tabindex="-1"></a>                          <span class="at">transition_probs =</span> mhmm_fit_i<span class="sc">$</span>model<span class="sc">$</span>transition_probs, </span>
<span id="cb38-11"><a href="#cb38-11" aria-hidden="true" tabindex="-1"></a>                          <span class="at">emission_probs =</span> mhmm_fit_i<span class="sc">$</span>model<span class="sc">$</span>emission_probs,</span>
<span id="cb38-12"><a href="#cb38-12" aria-hidden="true" tabindex="-1"></a>                          <span class="at">data =</span> cov_df,</span>
<span id="cb38-13"><a href="#cb38-13" aria-hidden="true" tabindex="-1"></a>                          <span class="at">formula =</span> <span class="sc">~</span> Attitude)</span>
<span id="cb38-14"><a href="#cb38-14" aria-hidden="true" tabindex="-1"></a>init_mhmm_3 <span class="ot">&lt;-</span> <span class="fu">build_mhmm</span>(<span class="at">observations =</span> <span class="fu">list</span>(eng_seq, ach_seq), </span>
<span id="cb38-15"><a href="#cb38-15" aria-hidden="true" tabindex="-1"></a>                          <span class="at">initial_probs =</span> mhmm_fit_i<span class="sc">$</span>model<span class="sc">$</span>initial_probs, </span>
<span id="cb38-16"><a href="#cb38-16" aria-hidden="true" tabindex="-1"></a>                          <span class="at">transition_probs =</span> mhmm_fit_i<span class="sc">$</span>model<span class="sc">$</span>transition_probs, </span>
<span id="cb38-17"><a href="#cb38-17" aria-hidden="true" tabindex="-1"></a>                          <span class="at">emission_probs =</span> mhmm_fit_i<span class="sc">$</span>model<span class="sc">$</span>emission_probs,</span>
<span id="cb38-18"><a href="#cb38-18" aria-hidden="true" tabindex="-1"></a>                          <span class="at">data =</span> cov_df,</span>
<span id="cb38-19"><a href="#cb38-19" aria-hidden="true" tabindex="-1"></a>                          <span class="at">formula =</span> <span class="sc">~</span> Gender)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>We estimate each model 50 + 1 times (first from the starting values we provided and then from 50 randomised values).</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb39"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb39-1"><a href="#cb39-1" aria-hidden="true" tabindex="-1"></a>mhmm_fit_1 <span class="ot">&lt;-</span> <span class="fu">fit_model</span>(init_mhmm_1, </span>
<span id="cb39-2"><a href="#cb39-2" aria-hidden="true" tabindex="-1"></a>                        <span class="at">control_em =</span> <span class="fu">list</span>(<span class="at">restart =</span> <span class="fu">list</span>(<span class="at">times =</span> <span class="dv">50</span>)))</span>
<span id="cb39-3"><a href="#cb39-3" aria-hidden="true" tabindex="-1"></a>mhmm_fit_2 <span class="ot">&lt;-</span> <span class="fu">fit_model</span>(init_mhmm_2, </span>
<span id="cb39-4"><a href="#cb39-4" aria-hidden="true" tabindex="-1"></a>                        <span class="at">control_em =</span> <span class="fu">list</span>(<span class="at">restart =</span> <span class="fu">list</span>(<span class="at">times =</span> <span class="dv">50</span>)))</span>
<span id="cb39-5"><a href="#cb39-5" aria-hidden="true" tabindex="-1"></a>mhmm_fit_3 <span class="ot">&lt;-</span> <span class="fu">fit_model</span>(init_mhmm_3, </span>
<span id="cb39-6"><a href="#cb39-6" aria-hidden="true" tabindex="-1"></a>                        <span class="at">control_em =</span> <span class="fu">list</span>(<span class="at">restart =</span> <span class="fu">list</span>(<span class="at">times =</span> <span class="dv">50</span>)))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Note that in an ideal analysis, however, one would vary the number of clusters and hidden states along with varying sets of covariates and initial probabilities in order to find the model settings which jointly optimise the BIC. Moreover, one is not limited to including only a single covariate; one could specify for example <code>formula = ~ Attitude + Gender</code>, but we omit this consideration here for simplicity. Furthermore, one should check in an ideal analysis that the optimal model was found in a majority of the 51 runs. We did so and can be satisfied that there are no convergence issues. We select among the three models with three different, single covariates using the BIC, and include the previous model with no covariates in the comparison also.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb40"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb40-1"><a href="#cb40-1" aria-hidden="true" tabindex="-1"></a><span class="fu">BIC</span>(mhmm_fit_i<span class="sc">$</span>model)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 3656.949</code></pre>
</div>
<div class="sourceCode cell-code" id="cb42"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb42-1"><a href="#cb42-1" aria-hidden="true" tabindex="-1"></a><span class="fu">BIC</span>(mhmm_fit_1<span class="sc">$</span>model)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 3614.673</code></pre>
</div>
<div class="sourceCode cell-code" id="cb44"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb44-1"><a href="#cb44-1" aria-hidden="true" tabindex="-1"></a><span class="fu">BIC</span>(mhmm_fit_2<span class="sc">$</span>model)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 3632.004</code></pre>
</div>
<div class="sourceCode cell-code" id="cb46"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb46-1"><a href="#cb46-1" aria-hidden="true" tabindex="-1"></a><span class="fu">BIC</span>(mhmm_fit_3<span class="sc">$</span>model)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 3649.353</code></pre>
</div>
</div>
<p>Recalling that lower BIC values are indicative of a better model, we can see that each covariate yields a better-fitting model. Though a better model could be found by adding more covariates or modifying the numbers of clusters and hidden states, we now proceed to interrogate, interpret, and visualise the results of the best model only; namely the MHMM with <code>Prev_grade</code> as a predictor of cluster membership.</p>
<p>We begin by examining the clusters via sequence index plots using <code>mssplot()</code>, as before, in <a href="#fig-trajec-covariate">Figure&nbsp;<span>13.11</span></a>.</p>
<div>
<div class="sourceCode cell-code" id="cb48"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb48-1"><a href="#cb48-1" aria-hidden="true" tabindex="-1"></a><span class="fu">mssplot</span>(mhmm_fit_1<span class="sc">$</span>model,  </span>
<span id="cb48-2"><a href="#cb48-2" aria-hidden="true" tabindex="-1"></a>        <span class="at">plots =</span> <span class="st">"both"</span>, </span>
<span id="cb48-3"><a href="#cb48-3" aria-hidden="true" tabindex="-1"></a>        <span class="at">type =</span> <span class="st">"I"</span>, </span>
<span id="cb48-4"><a href="#cb48-4" aria-hidden="true" tabindex="-1"></a>        <span class="at">sortv =</span> <span class="st">"mds.hidden"</span>,</span>
<span id="cb48-5"><a href="#cb48-5" aria-hidden="true" tabindex="-1"></a>        <span class="at">yaxis =</span> <span class="cn">TRUE</span>, </span>
<span id="cb48-6"><a href="#cb48-6" aria-hidden="true" tabindex="-1"></a>        <span class="at">with.legend =</span> <span class="st">"bottom"</span>,</span>
<span id="cb48-7"><a href="#cb48-7" aria-hidden="true" tabindex="-1"></a>        <span class="at">ncol.legend =</span> <span class="dv">1</span>,</span>
<span id="cb48-8"><a href="#cb48-8" aria-hidden="true" tabindex="-1"></a>        <span class="at">cex.title =</span> <span class="fl">1.3</span>,</span>
<span id="cb48-9"><a href="#cb48-9" aria-hidden="true" tabindex="-1"></a>        <span class="at">hidden.states.colors =</span> HIDDEN_STATES)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div id="fig-trajec-covariate" class="cell quarto-layout-panel">
<figure class="figure">
<div class="quarto-layout-row quarto-layout-valign-top">
<div class="cell-output-display quarto-layout-cell quarto-layout-cell-subref" style="flex-basis: 33.3%;justify-content: center;">
<div id="fig-trajec-covariate-1" class="quarto-figure quarto-figure-center anchored">
<figure class="figure">
<p><img src="ch13-multi_files/figure-html/fig-trajec-covariate-1.png" class="img-fluid figure-img" data-ref-parent="fig-trajec-covariate" width="1080"></p>
<p></p><figcaption class="figure-caption">(a) Cluster 1.</figcaption><p></p>
</figure>
</div>
</div>
<div class="cell-output-display quarto-layout-cell quarto-layout-cell-subref" style="flex-basis: 33.3%;justify-content: center;">
<div id="fig-trajec-covariate-2" class="quarto-figure quarto-figure-center anchored">
<figure class="figure">
<p><img src="ch13-multi_files/figure-html/fig-trajec-covariate-2.png" class="img-fluid figure-img" data-ref-parent="fig-trajec-covariate" width="1080"></p>
<p></p><figcaption class="figure-caption">(b) Cluster 2.</figcaption><p></p>
</figure>
</div>
</div>
<div class="cell-output-display quarto-layout-cell quarto-layout-cell-subref" style="flex-basis: 33.3%;justify-content: center;">
<div id="fig-trajec-covariate-3" class="quarto-figure quarto-figure-center anchored">
<figure class="figure">
<p><img src="ch13-multi_files/figure-html/fig-trajec-covariate-3.png" class="img-fluid figure-img" data-ref-parent="fig-trajec-covariate" width="1080"></p>
<p></p><figcaption class="figure-caption">(c) Cluster 3.</figcaption><p></p>
</figure>
</div>
</div>
</div>
<p></p><figcaption class="figure-caption"><strong>Figure</strong>&nbsp;11<strong>.</strong> Multi-channel sequence index plots for the optimal covariate-dependent MHMM.</figcaption><p></p>
</figure>
</div>
</div>
<p>Compared to <a href="#fig-trajec">Figure&nbsp;<span>13.10</span></a>, the results are notably similar. One observation previously assigned to the first trajectory is now assigned to the third, but the clusters retain precisely the same interpretations of Cluster 1 being mostly low achievers who move from averagely engaged to disengaged, Cluster 2 being mostly highly engaged high achievers, some of whom transition to being mostly intermediate achievers, and Cluster 3 being most averagely engaged or disengaged high or intermediate achievers, some of whom become more averagely engaged and highly achieving over time. It is worth noting that it is possible for the clusters and the interpretation thereof to change more drastically than this when covariates are added. As the clusters are very similar to what we found before, we give the clusters more informative labels as a reminder:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb49"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb49-1"><a href="#cb49-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cluster_names</span>(mhmm_fit_1<span class="sc">$</span>model) <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"LowEngLowAch"</span>, <span class="st">"HighEngHighAch"</span>, <span class="st">"LowEngHighAch"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>We now present a summary of the model which shows information about parameter estimates of covariates and prior and posterior cluster membership probabilities (these refer to cluster membership probabilities before or after conditioning on the observed sequences, respectively). In other words, prior probabilities set up the initial conditions and state transitions in the model before any data is observed, while posterior probabilities are calculated after observing data to estimate the likelihood of different states and observations given that data.</p>
<!-- Install the most recent version of seqHMM in order to get proper output (that old version doesn't show cluster labels properly) (S) -->
<div class="cell">
<div class="sourceCode cell-code" id="cb50"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb50-1"><a href="#cb50-1" aria-hidden="true" tabindex="-1"></a>summary_mhmm_1 <span class="ot">&lt;-</span> <span class="fu">summary</span>(mhmm_fit_1<span class="sc">$</span>model)</span>
<span id="cb50-2"><a href="#cb50-2" aria-hidden="true" tabindex="-1"></a>summary_mhmm_1</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Covariate effects :
LowEngLowAch is the reference.

HighEngHighAch :
             Estimate  Std. error
(Intercept)    -6.253       1.220
Prev_grade      0.817       0.159

LowEngHighAch :
             Estimate  Std. error
(Intercept)    -1.486       0.960
Prev_grade      0.158       0.139

Log-likelihood: -1708.843   BIC: 3614.673 

Means of prior cluster probabilities :
  LowEngLowAch HighEngHighAch  LowEngHighAch 
          0.40           0.34           0.26 

Most probable clusters :
            LowEngLowAch  HighEngHighAch  LowEngHighAch
count                 57              48             37
proportion         0.401           0.338          0.261

Classification table :
Mean cluster probabilities (in columns) by the most probable cluster (rows)

               LowEngLowAch HighEngHighAch LowEngHighAch
LowEngLowAch        0.98577        0.00702       0.00721
HighEngHighAch      0.00316        0.98499       0.01185
LowEngHighAch       0.01335        0.01552       0.97113</code></pre>
</div>
</div>
<p>We will first interpret the information on prior and posterior cluster membership probabilities and then proceed to interpreting covariate effects. Firstly, the section named <code>Means of prior cluster probabilities</code> gives information on how likely each cluster is in the whole population of students (40% in “LowEngLowAch”, 34% in “HighEngHighAch”, and 26% in “LowEngHighAch”). Secondly, the section <code>Most probable clusters</code> shows group sizes and proportions considering that each student would be classified into the cluster for which they have the highest cluster membership probability. Thirdly, the <code>Classification table</code> shows mean cluster probabilities (in columns) by the most probable cluster (in rows). We can see that the clusters are very crisp (the certainty of cluster memberships are very high) because the membership probabilities are large in the diagonal of the table.</p>
<p>The part titled <code>Covariate effects</code> shows the parameter estimates for the covariates. Interpretation of the values is similar to that of multinomial logistic regression, meaning that we can interpret the direction and uncertainty of the effect –relative to the reference level of “LowEngLowAch” – but we cannot directly interpret the magnitude of the effects. The magnitude of the <code>Prev_grade</code> coefficient is small with respect to its associated standard error, so we can say there is no significant relationship between previous grades and membership of the poorly engaged yet highly achieving “LowEngHighAch”. However, the large positive coefficient in “HighEngHighAch” indicates that students with high previous grades are more likely to belong to the highly engaged high achieving cluster, which makes intuitive sense.</p>
<p>The summary object also calculates prior and posterior cluster memberships for each student. We omit them here, for brevity, but demonstrate that they can be obtained as follows:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb52"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb52-1"><a href="#cb52-1" aria-hidden="true" tabindex="-1"></a>prior_prob <span class="ot">&lt;-</span> summary_mhmm_1<span class="sc">$</span>prior_cluster_probabilities</span>
<span id="cb52-2"><a href="#cb52-2" aria-hidden="true" tabindex="-1"></a>posterior_prob <span class="ot">&lt;-</span> summary_mhmm_1<span class="sc">$</span>posterior_cluster_probabilities</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>To obtain the most likely cluster assignment according to the posterior probabilites, we simply need to access the <code>most_probable_cluster</code> element from the summary object (<code>summary_mhmm_1</code>) and assign it to a dataframe in which the students are in the same order as in the dataframes used to create the sequence objects (<code>eng_seq_df</code> or <code>ach_seq_df</code>).</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb53"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb53-1"><a href="#cb53-1" aria-hidden="true" tabindex="-1"></a>eng_seq_df<span class="sc">$</span>ClusterMHMM <span class="ot">&lt;-</span> summary_mhmm_1<span class="sc">$</span>most_probable_cluster</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>If we are interested in getting the hidden state for each student for each timepoint, we may use the <code>hidden_paths()</code> function from <code>seqHMM</code> and pass the MHMM model as an argument (<code>mhmm_fit_1$model</code>). We then need to convert it to the long format to get a row per student and timepoint and then we extract only the <code>value</code> column to get only the hidden state. We can then assign the resulting vector to a column (e.g., <code>HiddenState</code>) in the original dataframe which follows the same data order.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb54"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb54-1"><a href="#cb54-1" aria-hidden="true" tabindex="-1"></a>df<span class="sc">$</span>HiddenState <span class="ot">&lt;-</span> <span class="fu">hidden_paths</span>(mhmm_fit_1<span class="sc">$</span>model) <span class="sc">|&gt;</span> <span class="fu">pivot_longer</span>(<span class="fu">everything</span>()) <span class="sc">|&gt;</span> <span class="fu">pull</span>(value)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Lastly, we advise readers to consult Chapter 12 for more examples of interpreting covariate effects in the context of MHMM models.</p>
</section>
</section>
<section id="discussion" class="level2" data-number="5">
<h2 data-number="5" class="anchored" data-anchor-id="discussion"><span class="header-section-number">5</span> Discussion</h2>
<p>This chapter has delved into the intriguing world of multi-channel sequence analysis, a method that deals with the analysis of two or more synchronised sequences. The ability to analyse multiple sequences in tandem offers a valuable perspective to understand the complexities of a temporal process. Throughout this chapter, we have highlighted the growing significance of multi-channel sequence analysis in educational research. While earlier chapters in this book focused on sequence analysis of learner-related data, this method presents an innovative approach to leverage the increasing availability of student multimodal temporal data. Our review of the existing literature that has utilised multi-channel sequence analysis concluded that the applications of this method within educational research are still relatively scarce. However, the potential of this framework is immense, as it opens up new possibilities to address the challenges posed by the complex and dynamic nature of educational data.</p>
<p>By exploring a case study on students’ online engagement and academic achievement, we demonstrated how multi-channel sequence analysis can reveal valuable insights into the longitudinal associations between these constructs. The identification of distinct trajectories through mixture hidden Markov models allows for a deep understanding of how both constructs evolve together over time and the distance-based clustering approach offers an alternative perspective on the group structure within these data. The step-by-step tutorial on implementing multi-channel sequence analysis with R according to both clustering frameworks provides readers with practical guidance to explore and apply these methods in their own research. Armed with this knowledge, researchers and educators can unlock valuable insights from their data and make informed decisions to support student learning and success.</p>
<p>Markovian models are relatively scalable and can be used to cluster large sequence data. Then again, unlike data-mining type sequence analysis, probabilistic models require making assumptions about the data-generating mechanisms which may not always be realistic. Furthermore, analysis of complex multi-channel sequence data can be very time consuming. Although we have highlighted the advantages of the model-based Markovian approach, particularly with regard to the ability to incorporate covariates as predictors of cluster membership, it is difficult to say if one approach is definitively better than the other for all potential use-cases. Although the BIC can be used to guide the choice of MHMM, particularly regarding the choice of the number of clusters (and numbers of hidden states within each cluster, and/or initial/transition/emission probabilities), we did not comprehensively do so here. Rather, we opted for three clusters, each with two hidden states, in both applications of MHMM herein, and only considered different initial probability settings and different covariates to arrive at the best model in terms of BIC. In an ideal analysis, one would compare different MHMM fits with different numbers of clusters and hidden states, different restrictions on the probabilities, and different covariates to arrive at an optimal model in terms of BIC.</p>
<p>Conversely, the choice of six clusters for the hierarchical clustering solution was arrived at in a different fashion, driven by the average silhouette width cluster quality measure. Indeed, the BIC cannot be used to choose the number of clusters with hierarchical clustering, nor can it be used to compare a hierarchical clustering solution with MHMM. However, it is interesting to note that the six clusters obtained by hierarchical clustering map reasonably well to the six hidden states of the MHMM solutions. As examples, considering the MHMM with fixed initial probabilities, one could say that clusters 4 and 5 of the hierarchical clustering solution, capturing averagely engaged and disengaged low achievers respectively, matches the two hidden states of the first MHMM cluster, while clusters 2 and 6, capturing actively engaged intermediate and high achievers respectively, matches the two hidden states of the second MHMM cluster.</p>
<p>Overall, we encourage readers to further explore the potential of multi-channel sequence analysis, the merits of both clustering approaches, and broader implications in the field of education by diving into the recommended readings. Together, we can harness the power of this framework to create meaningful and lasting impacts on student learning and educational research as a whole. The next section provides a list of valuable resources for readers to expand their knowledge on the topic.</p>
</section>
<section id="further-readings" class="level2" data-number="6">
<h2 data-number="6" class="anchored" data-anchor-id="further-readings"><span class="header-section-number">6</span> Further readings</h2>
<p>For more thorough presentations and comparisons of different options for the distance-based analysis of multi-channel sequences, we recommend the text book by Struffolino and Raab <span class="citation" data-cites="Raab2022">[<a href="../ch01-intro/intro.html#ref-Raab2022" role="doc-biblioref">35</a>]</span> and articles by Emery and Berchtold <span class="citation" data-cites="Emery2022">[<a href="../ch01-intro/intro.html#ref-Emery2022" role="doc-biblioref">8</a>]</span> and Ritschard et al. <span class="citation" data-cites="Ritschard2023">[<a href="../ch01-intro/intro.html#ref-Ritschard2023" role="doc-biblioref">12</a>]</span>. For assessing whether sequences in different channels are associated to the extent of needing joint analysis, Piccarreta and Elzinga <span class="citation" data-cites="Piccarreta2013 Piccarreta2017">[<a href="../ch01-intro/intro.html#ref-Piccarreta2013" role="doc-biblioref">36</a>, <a href="../ch01-intro/intro.html#ref-Piccarreta2017" role="doc-biblioref">37</a>]</span> have proposed solutions for quantifying the extent of association between two or more channels using Cronbach’s <span class="math inline">\(\alpha\)</span> and principal component analysis.</p>
<p>For general presentations of the MHMM for multi-channel sequences, see the chapter by Vermunt et al. <span class="citation" data-cites="Vermunt2008">[<a href="../ch01-intro/intro.html#ref-Vermunt2008" role="doc-biblioref">38</a>]</span> and the article by Helske and Helske <span class="citation" data-cites="Helske2019">[<a href="../ch01-intro/intro.html#ref-Helske2019" role="doc-biblioref">18</a>]</span>. For further examples and tips for visualization of multi-channel sequence data and estimation of Markovian models with the <code>seqHMM</code> package, see the <code>seqHMM</code> vignettes <span class="citation" data-cites="Helske2017a Helske2017b">[<a href="../ch01-intro/intro.html#ref-Helske2017a" role="doc-biblioref">39</a>, <a href="../ch01-intro/intro.html#ref-Helske2017b" role="doc-biblioref">40</a>]</span>.</p>
<p>To learn how to combine distance-based sequence analysis and hidden Markov models for the analysis of complex multi-channel sequence data with partially missing observations, see the chapter by Helske et al. <span class="citation" data-cites="Helske2018">[<a href="../ch01-intro/intro.html#ref-Helske2018" role="doc-biblioref">6</a>]</span>.</p>
</section>
<section id="acknowledgements" class="level2" data-number="7">
<h2 data-number="7" class="anchored" data-anchor-id="acknowledgements"><span class="header-section-number">7</span> Acknowledgements</h2>
<p>SH was supported by the Academy of Finland (decision number 331816), the Academy of Finland Flagship Programme (decision number 320162), and the Strategic Research Council (SRC), FLUX consortium (decision numbers: 345130 and 345130). MS was supported by the Academy of Finland (TOPEILA: Towards precision education: Idiographic learning analytics, grant 350560).</p>


</section>
<section id="bibliography" class="level1 unnumbered">
<h1 class="unnumbered">References</h1>
<div id="refs" class="references csl-bib-body" role="doc-bibliography" style="display: none">
<div id="ref-Saqr2019" class="csl-entry" role="doc-biblioentry">
<div class="csl-left-margin">1. </div><div class="csl-right-inline">Saqr M, Nouri J, Fors U (2019) Time to focus on the temporal dimension of learning: A learning analytics study of the temporal patterns of students’ interactions and self-regulation. International Journal of Technology Enhanced Learning 11:398. https://doi.org/<a href="https://doi.org/10.1504/ijtel.2019.102549">10.1504/ijtel.2019.102549</a></div>
</div>
<div id="ref-saqr2023temporal" class="csl-entry" role="doc-biblioentry">
<div class="csl-left-margin">2. </div><div class="csl-right-inline">Saqr M, López-Pernas S (2023) The temporal dynamics of online problem-based learning: Why and when sequence matters. International Journal of Computer-Supported Collaborative Learning 18:11–37. https://doi.org/<a href="https://doi.org/10.1007/s11412-023-09385-1">10.1007/s11412-023-09385-1</a></div>
</div>
<div id="ref-Saqr2024-tv" class="csl-entry" role="doc-biblioentry">
<div class="csl-left-margin">3. </div><div class="csl-right-inline">Saqr M, López-Pernas S, Helske S, Durand M, Murphy K, Studer M, Ritschard G (2024) Sequence analysis in education: Principles, technique, and tutorial with r. In: Saqr M, López-Pernas S (eds) Learning analytics methods and tutorials: A practical guide using <span>R</span>. Springer</div>
</div>
<div id="ref-Lopez-Pernas2024-lz" class="csl-entry" role="doc-biblioentry">
<div class="csl-left-margin">4. </div><div class="csl-right-inline">López-Pernas S, Saqr M (2024) Modeling the dynamics of longitudinal processes in education. A tutorial with r for the VaSSTra method. In: Saqr M, López-Pernas S (eds) Learning analytics methods and tutorials: A practical guide using <span>R</span>. Springer, pp in–press</div>
</div>
<div id="ref-Helske2024-lq" class="csl-entry" role="doc-biblioentry">
<div class="csl-left-margin">5. </div><div class="csl-right-inline">Helske J, Helske S, Saqr M, López-Pernas S, Murphy K (2024) A modern approach to transition analysis and process mining with markov models: A tutorial with <span>R</span>. In: Saqr M, López-Pernas S (eds) Learning analytics methods and tutorials: A practical guide using <span>R</span>. Springer, pp in–press</div>
</div>
<div id="ref-Helske2018" class="csl-entry" role="doc-biblioentry">
<div class="csl-left-margin">6. </div><div class="csl-right-inline">Helske S, Helske J, Eerola M (2018) <a href="https://doi.org/10.1007/978-3-319-95420-2_11">Combining sequence analysis and hidden <span>M</span>arkov models in the analysis of complex life sequence data</a>. In: Life course research and social policies. Springer International Publishing, pp 185–200</div>
</div>
<div id="ref-EisenbergGuyot2020" class="csl-entry" role="doc-biblioentry">
<div class="csl-left-margin">7. </div><div class="csl-right-inline">Eisenberg-Guyot J, Peckham T, Andrea SB, Oddo V, Seixas N, Hajat A (2020) Life-course trajectories of employment quality and health in the <span>U.S.</span>: A multichannel sequence analysis. Social Science &amp; Medicine 264:113327. https://doi.org/<a href="https://doi.org/10.1016/j.socscimed.2020.113327">10.1016/j.socscimed.2020.113327</a></div>
</div>
<div id="ref-Emery2022" class="csl-entry" role="doc-biblioentry">
<div class="csl-left-margin">8. </div><div class="csl-right-inline">Emery K, Berchtold A (2022) Comparison of two approaches in multichannel sequence analysis using the <span>Swiss Household Panel</span>. Longitudinal and Life Course Studies 1–32. https://doi.org/<a href="https://doi.org/10.1332/175795921x16698302233894">10.1332/175795921x16698302233894</a></div>
</div>
<div id="ref-Gauthier2010" class="csl-entry" role="doc-biblioentry">
<div class="csl-left-margin">9. </div><div class="csl-right-inline">Gauthier J-A, Widmer ED, Bucher P, Notredame C (2010) Multichannel sequence analysis applied to social science data. Sociological Methodology 40:1–38. https://doi.org/<a href="https://doi.org/10.1111/j.1467-9531.2010.01227.x">10.1111/j.1467-9531.2010.01227.x</a></div>
</div>
<div id="ref-Saqr2023" class="csl-entry" role="doc-biblioentry">
<div class="csl-left-margin">10. </div><div class="csl-right-inline">Saqr M, López-Pernas S, Helske S, Hrastinski S (2023) The longitudinal association between engagement and achievement varies by time, students’ profiles, and achievement state: A full program study. Computers &amp; Education 199:104787. https://doi.org/<a href="https://doi.org/10.1016/j.compedu.2023.104787">10.1016/j.compedu.2023.104787</a></div>
</div>
<div id="ref-Winne2020" class="csl-entry" role="doc-biblioentry">
<div class="csl-left-margin">11. </div><div class="csl-right-inline">Winne PH (2020) Construct and consequential validity for learning analytics based on trace data. Computers in Human Behavior 112:106457. https://doi.org/<a href="https://doi.org/10.1016/j.chb.2020.106457">10.1016/j.chb.2020.106457</a></div>
</div>
<div id="ref-Ritschard2023" class="csl-entry" role="doc-biblioentry">
<div class="csl-left-margin">12. </div><div class="csl-right-inline">Ritschard G, Liao TF, Struffolino E (2023) Strategies for multidomain sequence analyis in social research. Sociological Methodology 53:288–322. https://doi.org/<a href="https://doi.org/10.1177/0081175023116383">10.1177/0081175023116383</a></div>
</div>
<div id="ref-pollock2007" class="csl-entry" role="doc-biblioentry">
<div class="csl-left-margin">13. </div><div class="csl-right-inline">Pollock G (2007) <a href="https://www.jstor.org/stable/4623140">Holistic trajectories: A study of combined employment, housing and family careers by using multiple-sequence analysis</a>. Journal of the Royal Statistical Society: Series A (Statistics in Society) 170:167–183</div>
</div>
<div id="ref-IHE" class="csl-entry" role="doc-biblioentry">
<div class="csl-left-margin">14. </div><div class="csl-right-inline">Saqr M, López-Pernas S, Jovanović J, Gašević D (2023) Intense, turbulent, or wallowing in the mire: A longitudinal study of cross-course online tactics, strategies, and trajectories. The Internet and Higher Education 57:100902</div>
</div>
<div id="ref-BOUGUETTAYA20152785" class="csl-entry" role="doc-biblioentry">
<div class="csl-left-margin">15. </div><div class="csl-right-inline">Bouguettaya A, Yu Q, Liu X, Zhou X, Song A (2015) Efficient agglomerative hierarchical clustering. Expert Systems with Applications 42:2785–2797. https://doi.org/<a href="https://doi.org/10.1016/j.eswa.2014.09.054">https://doi.org/10.1016/j.eswa.2014.09.054</a></div>
</div>
<div id="ref-Gilpin13" class="csl-entry" role="doc-biblioentry">
<div class="csl-left-margin">16. </div><div class="csl-right-inline">Gilpin S, Qian B, Davidson I (2013) <a href="https://doi.org/10.1145/2505515.2505527">Efficient hierarchical clustering of large high dimensional datasets</a>. In: Proceedings of the 22nd ACM international conference on information &amp; knowledge management. Association for Computing Machinery, New York, NY, USA, pp 1371–1380</div>
</div>
<div id="ref-studer2013" class="csl-entry" role="doc-biblioentry">
<div class="csl-left-margin">17. </div><div class="csl-right-inline">Studer M (2013) <span>WeightedCluster</span> library manual: A practical guide to creating typologies of trajectories in the social sciences with <span>R</span>. LIVES. <a href="https://doi.org/10.12682/LIVES.2296-1658.2013.24">https://doi.org/10.12682/LIVES.2296-1658.2013.24</a></div>
</div>
<div id="ref-Helske2019" class="csl-entry" role="doc-biblioentry">
<div class="csl-left-margin">18. </div><div class="csl-right-inline">Helske S, Helske J (2019) Mixture hidden <span>M</span>arkov models for sequence data: The seq<span>HMM</span> package in <span>R</span>. Journal of Statistical Software 88: https://doi.org/<a href="https://doi.org/10.18637/jss.v088.i03">10.18637/jss.v088.i03</a></div>
</div>
<div id="ref-schwarz1978" class="csl-entry" role="doc-biblioentry">
<div class="csl-left-margin">19. </div><div class="csl-right-inline">Schwarz GE (1978) Estimating the dimension of a model. The Annals of Statistics 6:461–464. https://doi.org/<a href="https://doi.org/10.1214/aos/1176344136">10.1214/aos/1176344136</a></div>
</div>
<div id="ref-seqHMM" class="csl-entry" role="doc-biblioentry">
<div class="csl-left-margin">20. </div><div class="csl-right-inline">Helske J, Helske S (2023) <a href="https://cran.r-project.org/package=seqHMM"><span class="nocase">seqHMM</span>: Mixture hidden <span>Markov</span> models for social sequence data and other multivariate, multichannel categorical time series</a></div>
</div>
<div id="ref-MEDseq" class="csl-entry" role="doc-biblioentry">
<div class="csl-left-margin">21. </div><div class="csl-right-inline">Murphy K, Murphy TB, Piccarreta R, C. GI (2021) Clustering longitudinal life-course sequences using mixtures of exponential-distance models. Journal of the Royal Statistical Society: Seria A (Statistics in Society) 184:1414–1451</div>
</div>
<div id="ref-Studer2018-aw" class="csl-entry" role="doc-biblioentry">
<div class="csl-left-margin">22. </div><div class="csl-right-inline">Studer M (2018) <a href="https://doi.org/10.1007/978-3-319-95420-2\_13">Divisive <span>Property-Based</span> and fuzzy clustering for sequence analysis</a>. In: Ritschard G, Studer M (eds) Sequence analysis and related approaches: Innovative methods and applications. Springer International Publishing, Cham, pp 223–239</div>
</div>
<div id="ref-Helske2023-yj" class="csl-entry" role="doc-biblioentry">
<div class="csl-left-margin">23. </div><div class="csl-right-inline">Helske S, Helske J, Chihaya GK (2023) From sequences to variables: Rethinking the relationship between sequences and outcomes. Sociol Methodol 00811750231177026. https://doi.org/<a href="https://doi.org/10.1177/00811750231177026">10.1177/00811750231177026</a></div>
</div>
<div id="ref-Dayton1988" class="csl-entry" role="doc-biblioentry">
<div class="csl-left-margin">24. </div><div class="csl-right-inline">Dayton CM, Macready GB (1988) <span>C</span>oncomitant-variable latent-class models. Journal of the American Statistical Association 83:173–178</div>
</div>
<div id="ref-MoEClust" class="csl-entry" role="doc-biblioentry">
<div class="csl-left-margin">25. </div><div class="csl-right-inline">Murphy K, Murphy TB (2020) <span>G</span>aussian parsimonious clustering models with covariates and a noise component. Advances in Data Analysis and Classification 14:293–325</div>
</div>
<div id="ref-Trmnen2022a" class="csl-entry" role="doc-biblioentry">
<div class="csl-left-margin">26. </div><div class="csl-right-inline">Törmänen T, Järvenoja H, Saqr M, Malmberg J, Järvelä S (2022) A person-centered approach to study students’ socio-emotional interaction profiles and regulation of collaborative learning. Frontiers in Education 7: https://doi.org/<a href="https://doi.org/10.3389/feduc.2022.866612">10.3389/feduc.2022.866612</a></div>
</div>
<div id="ref-Trmnen2022b" class="csl-entry" role="doc-biblioentry">
<div class="csl-left-margin">27. </div><div class="csl-right-inline">Törmänen T, Järvenoja H, Saqr M, Malmberg J, Järvelä S (2022) Affective states and regulation of learning during socio-emotional interactions in secondary school collaborative groups. British Journal of Educational Psychology 93:48–70. https://doi.org/<a href="https://doi.org/10.1111/bjep.12525">10.1111/bjep.12525</a></div>
</div>
<div id="ref-Ouyang2023" class="csl-entry" role="doc-biblioentry">
<div class="csl-left-margin">28. </div><div class="csl-right-inline">Ouyang F, Xu W, Cukurova M (2023) An artificial intelligence-driven learning analytics method to examine the collaborative problem-solving process from the complex adaptive systems perspective. International Journal of Computer-Supported Collaborative Learning 18:39–66. https://doi.org/<a href="https://doi.org/10.1007/s11412-023-09387-z">10.1007/s11412-023-09387-z</a></div>
</div>
<div id="ref-LopezPernas2021" class="csl-entry" role="doc-biblioentry">
<div class="csl-left-margin">29. </div><div class="csl-right-inline">Lopez-Pernas S, Saqr M (2021) Bringing synchrony and clarity to complex multi-channel data: A learning analytics study in programming education. <span>IEEE</span> Access 9:166531–166541. https://doi.org/<a href="https://doi.org/10.1109/access.2021.3134844">10.1109/access.2021.3134844</a></div>
</div>
<div id="ref-Bacci2022" class="csl-entry" role="doc-biblioentry">
<div class="csl-left-margin">30. </div><div class="csl-right-inline">Bacci S, Bertaccini B (2022) A mixture hidden <span>M</span>arkov model to mine students’ university curricula. Data 7:25. https://doi.org/<a href="https://doi.org/10.3390/data7020025">10.3390/data7020025</a></div>
</div>
<div id="ref-Liu2021" class="csl-entry" role="doc-biblioentry">
<div class="csl-left-margin">31. </div><div class="csl-right-inline">Liu B, Widener MJ, Smith LG, Farber S, Minaker LM, Patterson Z, Larsen K, Gilliland J (2021) Disentangling time use, food environment, and food behaviors using multi-channel sequence analysis. Geographical Analysis 54:881–917. https://doi.org/<a href="https://doi.org/10.1111/gean.12305">10.1111/gean.12305</a></div>
</div>
<div id="ref-rio" class="csl-entry" role="doc-biblioentry">
<div class="csl-left-margin">32. </div><div class="csl-right-inline">Chan C, Chan GC, Leeper TJ, Becker J (2021) Rio: A <span>S</span>wiss-army knife for data file <span>I/O</span></div>
</div>
<div id="ref-tidyverse" class="csl-entry" role="doc-biblioentry">
<div class="csl-left-margin">33. </div><div class="csl-right-inline">Wickham H, Averick M, Bryan J, Chang W, McGowan LD, François R, Grolemund G, Hayes A, Henry L, Hester J, Kuhn M, Pedersen TL, Miller E, Bache SM, Müller K, Ooms J, Robinson D, Seidel DP, Spinu V, Takahashi K, Vaughan D, Wilke C, Woo K, Yutani H (2019) Welcome to the <span class="nocase">tidyverse</span>. Journal of Open Source Software 4:1686. https://doi.org/<a href="https://doi.org/10.21105/joss.01686">10.21105/joss.01686</a></div>
</div>
<div id="ref-Gabadinho2011" class="csl-entry" role="doc-biblioentry">
<div class="csl-left-margin">34. </div><div class="csl-right-inline">Gabadinho A, Ritschard G, Müller NS, Studer M (2011) Analyzing and visualizing state sequences in <span>R</span> with <span>TraMineR</span>. Journal of Statistical Software 40: https://doi.org/<a href="https://doi.org/10.18637/jss.v040.i04">10.18637/jss.v040.i04</a></div>
</div>
<div id="ref-Raab2022" class="csl-entry" role="doc-biblioentry">
<div class="csl-left-margin">35. </div><div class="csl-right-inline">Raab M, Struffolino E (2022) Sequence analysis. SAGE Publications</div>
</div>
<div id="ref-Piccarreta2013" class="csl-entry" role="doc-biblioentry">
<div class="csl-left-margin">36. </div><div class="csl-right-inline">Piccarreta R, Elzinga CH (2013) Mining for association between life course domains. In: Contemporary issues in exploratory data mining in the behavioral sciences. Routledge, pp 212–242</div>
</div>
<div id="ref-Piccarreta2017" class="csl-entry" role="doc-biblioentry">
<div class="csl-left-margin">37. </div><div class="csl-right-inline">Piccarreta R (2017) Joint sequence analysis: Association and clustering. Sociological Methods &amp; Research 46:252–287</div>
</div>
<div id="ref-Vermunt2008" class="csl-entry" role="doc-biblioentry">
<div class="csl-left-margin">38. </div><div class="csl-right-inline">Vermunt JK, Tran B, Magidson J (2008) Latent class models in longitudinal research. Handbook of longitudinal research: Design, measurement, and analysis 373–385</div>
</div>
<div id="ref-Helske2017a" class="csl-entry" role="doc-biblioentry">
<div class="csl-left-margin">39. </div><div class="csl-right-inline">Helske S (2017) Visualization tools in the seqHMM package</div>
</div>
<div id="ref-Helske2017b" class="csl-entry" role="doc-biblioentry">
<div class="csl-left-margin">40. </div><div class="csl-right-inline">Helske S (2017) Examples and tips for estimating markovian models with seqHMM</div>
</div>
</div>
</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    target: function(trigger) {
      return trigger.previousElementSibling;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  function tippyHover(el, contentFn) {
    const config = {
      allowHTML: true,
      content: contentFn,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start'
    };
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
<nav class="page-navigation">
  <div class="nav-page nav-page-previous">
      <a href="../../chapters/ch12-markov/ch12-markov.html" class="pagination-link">
        <i class="bi bi-arrow-left-short"></i> <span class="nav-page-text"><span class="chapter-number">12</span>&nbsp; <span class="chapter-title">Markov models</span></span>
      </a>          
  </div>
  <div class="nav-page nav-page-next">
      <a href="../../chapters/ch14-process-mining/ch14-process.html" class="pagination-link">
        <span class="nav-page-text"><span class="chapter-number">14</span>&nbsp; <span class="chapter-title">Process mining</span></span> <i class="bi bi-arrow-right-short"></i>
      </a>
  </div>
</nav>
</div> <!-- /content -->
<footer class="footer">
  <div class="nav-footer">
      <div class="nav-footer-center"><div class="cookie-consent-footer"><a href="#" id="open_preferences_center">Cookie Preferences</a></div></div>
  </div>
</footer>
<script>
  document.querySelector(".quarto-title").innerHTML =  '<div class="badge bs-warning bg-warning text-dark" style="float:right;">Pre-print</div>' +  document.querySelector(".quarto-title").innerHTML
  var keywords = document.querySelector('meta[name="keywords"]')
  if (keywords && keywords.content) {
    document.getElementById("title-block-header").innerHTML = document.getElementById("title-block-header").innerHTML + 
      '<div class="abstract"><div class="abstract-title">Keywords</div><div class="quarto-title-meta-contents"><p>'+
      keywords.content +
      '</p></div></div>'
  }
</script>



</body></html>